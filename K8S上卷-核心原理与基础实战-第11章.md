# ç¬¬11ç«  Kubernetesè°ƒè¯•ä¸æ•…éšœæ’æŸ¥

## æœ¬ç« æ¦‚è¿°

åœ¨å‰é¢çš„ç« èŠ‚ä¸­,æˆ‘ä»¬ç³»ç»Ÿå­¦ä¹ äº†Kubernetesçš„æ ¸å¿ƒæ¦‚å¿µã€èµ„æºç®¡ç†ã€ç½‘ç»œå­˜å‚¨ã€å®‰å…¨æœºåˆ¶ã€ç›‘æ§å¯è§‚æµ‹æ€§ä»¥åŠé«˜çº§ç‰¹æ€§ã€‚ç„¶è€Œ,åœ¨ç”Ÿäº§ç¯å¢ƒä¸­,é—®é¢˜å’Œæ•…éšœæ˜¯ä¸å¯é¿å…çš„ã€‚ä¸€ä¸ªæˆç†Ÿçš„Kuberneteså·¥ç¨‹å¸ˆä¸ä»…è¦ä¼šéƒ¨ç½²åº”ç”¨,æ›´è¦èƒ½å¤Ÿå¿«é€Ÿå®šä½å’Œè§£å†³å„ç§ç–‘éš¾é—®é¢˜ã€‚

**ä¸ºä»€ä¹ˆè°ƒè¯•ä¸æ•…éšœæ’æŸ¥å¦‚æ­¤é‡è¦?**

è€ƒè™‘ä»¥ä¸‹ç”Ÿäº§åœºæ™¯:

ğŸš¨ **åº”ç”¨æ•…éšœåœºæ™¯**:
- Podä¸€ç›´å¤„äºPendingçŠ¶æ€,æ— æ³•è°ƒåº¦åˆ°èŠ‚ç‚¹
- å®¹å™¨åå¤CrashLoopBackOff,æ—¥å¿—æ˜¾ç¤ºå†…å­˜ä¸è¶³
- Serviceæ— æ³•è®¿é—®,ä½†PodçŠ¶æ€æ­£å¸¸
- Ingressé…ç½®æ­£ç¡®,ä½†åŸŸåæ— æ³•è§£æ
- StatefulSetæ»šåŠ¨æ›´æ–°å¡ä½,åªæ›´æ–°äº†ä¸€ä¸ªPod

ğŸ”¥ **æ€§èƒ½é—®é¢˜åœºæ™¯**:
- APIè¯·æ±‚å»¶è¿Ÿçªç„¶ä»100mså¢åŠ åˆ°5ç§’
- èŠ‚ç‚¹CPU/å†…å­˜èµ„æºè€—å°½,å¤§é‡Podè¢«é©±é€
- etcdæ€§èƒ½ä¸‹é™,API Serverå“åº”ç¼“æ…¢
- ç½‘ç»œååé‡å¼‚å¸¸,Podé—´é€šä¿¡ä¸¢åŒ…ç‡é«˜
- å­˜å‚¨IOæ€§èƒ½å·®,æ•°æ®åº“å“åº”æ…¢

ğŸŒŠ **é›†ç¾¤çº§æ•…éšœåœºæ™¯**:
- MasterèŠ‚ç‚¹å®•æœº,æ§åˆ¶å¹³é¢ä¸å¯ç”¨
- WorkerèŠ‚ç‚¹NotReady,Podå¤§è§„æ¨¡è¿ç§»
- DNSæœåŠ¡æ•…éšœ,æ‰€æœ‰æœåŠ¡å‘ç°å¤±è´¥
- CNIæ’ä»¶å¼‚å¸¸,æ–°å»ºPodæ— æ³•åˆ†é…IP
- Controller Manager OOM,æ§åˆ¶å™¨åœæ­¢å·¥ä½œ

è¿™äº›é—®é¢˜å¦‚æœä¸èƒ½å¿«é€Ÿå®šä½å’Œè§£å†³,å°†å¯¼è‡´:
- **ä¸šåŠ¡ä¸­æ–­** - ç”¨æˆ·æ— æ³•è®¿é—®æœåŠ¡,é€ æˆç»æµæŸå¤±
- **æ•°æ®ä¸¢å¤±** - æŒä¹…åŒ–å­˜å‚¨é—®é¢˜å¯¼è‡´æ•°æ®æŸå
- **é›ªå´©æ•ˆåº”** - ä¸€ä¸ªç»„ä»¶æ•…éšœå¼•å‘è¿é”ååº”
- **ä¿¡ä»»å±æœº** - é¢‘ç¹æ•…éšœå½±å“å›¢é˜Ÿå¯¹Kubernetesçš„ä¿¡å¿ƒ

**æœ¬ç« ä¸»è¦å†…å®¹**:

1. **è°ƒè¯•å·¥å…·ä¸æ–¹æ³•è®º** (11.1)
   - ç³»ç»ŸåŒ–æ•…éšœæ’æŸ¥æ–¹æ³•
   - kubectlæ ¸å¿ƒè°ƒè¯•å‘½ä»¤
   - å®¹å™¨å†…è°ƒè¯•æŠ€å·§
   - ç½‘ç»œè°ƒè¯•å·¥å…·é“¾

2. **Podæ•…éšœæ’æŸ¥** (11.2)
   - Podç”Ÿå‘½å‘¨æœŸé—®é¢˜
   - é•œåƒæ‹‰å–å¤±è´¥
   - èµ„æºä¸è¶³å¯¼è‡´çš„é—®é¢˜
   - å¥åº·æ£€æŸ¥é…ç½®é”™è¯¯

3. **ç½‘ç»œé—®é¢˜è¯Šæ–­** (11.3)
   - Serviceä¸å¯è¾¾
   - DNSè§£æå¤±è´¥
   - ç½‘ç»œç­–ç•¥é—®é¢˜
   - CNIæ’ä»¶æ•…éšœ

4. **å­˜å‚¨æ•…éšœå¤„ç†** (11.4)
   - PVCç»‘å®šå¤±è´¥
   - å­˜å‚¨æ€§èƒ½é—®é¢˜
   - æ•°æ®ä¸¢å¤±æ¢å¤
   - StorageClassé…ç½®

5. **èŠ‚ç‚¹ä¸é›†ç¾¤æ•…éšœ** (11.5)
   - èŠ‚ç‚¹NotReadyè¯Šæ–­
   - æ§åˆ¶å¹³é¢ç»„ä»¶æ•…éšœ
   - etcdé›†ç¾¤é—®é¢˜
   - èµ„æºè€—å°½å¤„ç†

6. **åº”ç”¨è°ƒè¯•æœ€ä½³å®è·µ** (11.6)
   - æ—¥å¿—åˆ†ææŠ€å·§
   - æ€§èƒ½åˆ†æå·¥å…·
   - è¿œç¨‹è°ƒè¯•æ–¹æ³•
   - ç”Ÿäº§ç¯å¢ƒdebugæŠ€å·§

7. **æ•…éšœæ¡ˆä¾‹åˆ†æ** (11.7)
   - çœŸå®ç”Ÿäº§æ•…éšœå¤ç›˜
   - æ ¹å› åˆ†ææ–¹æ³•
   - é¢„é˜²æªæ–½åˆ¶å®š
   - åº”æ€¥å“åº”æµç¨‹

8. **æœ¬ç« æ€»ç»“** (11.8)
   - æ ¸å¿ƒçŸ¥è¯†å›é¡¾
   - è°ƒè¯•æŠ€èƒ½æ¸…å•
   - å­¦ä¹ èµ„æºæ¨è

**å­¦ä¹ ç›®æ ‡**:

- âœ… æŒæ¡ç³»ç»ŸåŒ–çš„æ•…éšœæ’æŸ¥æ–¹æ³•è®º
- âœ… ç†Ÿç»ƒä½¿ç”¨kubectlå’Œå®¹å™¨è°ƒè¯•å·¥å…·
- âœ… èƒ½å¤Ÿå¿«é€Ÿå®šä½Podã€ç½‘ç»œã€å­˜å‚¨é—®é¢˜
- âœ… ç†è§£é›†ç¾¤çº§æ•…éšœçš„è¯Šæ–­æµç¨‹
- âœ… å­¦ä¼šåˆ†æç”Ÿäº§ç¯å¢ƒå¤æ‚é—®é¢˜
- âœ… å»ºç«‹é¢„é˜²æ€§æ•…éšœå¤„ç†æœºåˆ¶

**å‰ç½®çŸ¥è¯†**:

- ç†Ÿæ‚‰Kubernetesæ ¸å¿ƒæ¦‚å¿µ(ç¬¬1-4ç« )
- ç†è§£ç½‘ç»œå’Œå­˜å‚¨æœºåˆ¶(ç¬¬5-6ç« )
- æŒæ¡ç›‘æ§å’Œæ—¥å¿—åˆ†æ(ç¬¬9ç« )

**æŠ€èƒ½ç­‰çº§è¦æ±‚**:

```yaml
åˆçº§è¿ç»´å·¥ç¨‹å¸ˆ:
  - ä¼šä½¿ç”¨kubectl describe/logsæŸ¥çœ‹åŸºç¡€ä¿¡æ¯
  - èƒ½å¤Ÿè¯†åˆ«Podçš„å¸¸è§é”™è¯¯çŠ¶æ€
  - äº†è§£åŸºæœ¬çš„æ•…éšœæ’æŸ¥æµç¨‹

ä¸­çº§è¿ç»´å·¥ç¨‹å¸ˆ:
  - ç†Ÿç»ƒä½¿ç”¨æ‰€æœ‰kubectlè°ƒè¯•å‘½ä»¤
  - èƒ½å¤Ÿè¯Šæ–­ç½‘ç»œå’Œå­˜å‚¨é—®é¢˜
  - æŒæ¡èŠ‚ç‚¹çº§æ•…éšœæ’æŸ¥
  - ä¼šä½¿ç”¨tcpdumpã€straceç­‰ç³»ç»Ÿå·¥å…·

é«˜çº§è¿ç»´å·¥ç¨‹å¸ˆ/SRE:
  - èƒ½å¤Ÿåˆ†æå¤æ‚çš„é›†ç¾¤çº§æ•…éšœ
  - æŒæ¡æ€§èƒ½åˆ†æå’Œä¼˜åŒ–æ–¹æ³•
  - ä¼šç¼–å†™è‡ªåŠ¨åŒ–æ•…éšœè¯Šæ–­è„šæœ¬
  - èƒ½å¤Ÿé¢„æµ‹å’Œé¢„é˜²æ½œåœ¨é—®é¢˜
```

---

## æœ¬ç« å†…å®¹æ¦‚è§ˆ

```
ç¬¬11ç« : Kubernetesè°ƒè¯•ä¸æ•…éšœæ’æŸ¥
â”œâ”€â”€ 11.1 è°ƒè¯•å·¥å…·ä¸æ–¹æ³•è®º
â”‚   â”œâ”€â”€ ç³»ç»ŸåŒ–æ•…éšœæ’æŸ¥æµç¨‹
â”‚   â”œâ”€â”€ kubectlæ ¸å¿ƒè°ƒè¯•å‘½ä»¤
â”‚   â”œâ”€â”€ å®¹å™¨å†…è°ƒè¯•æŠ€å·§
â”‚   â””â”€â”€ ç½‘ç»œè°ƒè¯•å·¥å…·é“¾
â”‚
â”œâ”€â”€ 11.2 Podæ•…éšœæ’æŸ¥
â”‚   â”œâ”€â”€ PendingçŠ¶æ€è¯Šæ–­
â”‚   â”œâ”€â”€ CrashLoopBackOffåˆ†æ
â”‚   â”œâ”€â”€ ImagePullBackOffè§£å†³
â”‚   â”œâ”€â”€ OOMKilledå¤„ç†
â”‚   â””â”€â”€ Initå®¹å™¨å¤±è´¥è°ƒè¯•
â”‚
â”œâ”€â”€ 11.3 ç½‘ç»œé—®é¢˜è¯Šæ–­
â”‚   â”œâ”€â”€ Serviceä¸å¯è¾¾æ’æŸ¥
â”‚   â”œâ”€â”€ DNSè§£æé—®é¢˜
â”‚   â”œâ”€â”€ NetworkPolicyè°ƒè¯•
â”‚   â”œâ”€â”€ CNIæ’ä»¶æ•…éšœ
â”‚   â””â”€â”€ Ingressé…ç½®é—®é¢˜
â”‚
â”œâ”€â”€ 11.4 å­˜å‚¨æ•…éšœå¤„ç†
â”‚   â”œâ”€â”€ PVC Pendingæ’æŸ¥
â”‚   â”œâ”€â”€ æŒ‚è½½å¤±è´¥è¯Šæ–­
â”‚   â”œâ”€â”€ å­˜å‚¨æ€§èƒ½åˆ†æ
â”‚   â”œâ”€â”€ æ•°æ®æ¢å¤æ–¹æ³•
â”‚   â””â”€â”€ CSIé©±åŠ¨é—®é¢˜
â”‚
â”œâ”€â”€ 11.5 èŠ‚ç‚¹ä¸é›†ç¾¤æ•…éšœ
â”‚   â”œâ”€â”€ èŠ‚ç‚¹NotReadyè¯Šæ–­
â”‚   â”œâ”€â”€ kubeletæ•…éšœæ’æŸ¥
â”‚   â”œâ”€â”€ æ§åˆ¶å¹³é¢ç»„ä»¶å¼‚å¸¸
â”‚   â”œâ”€â”€ etcdé›†ç¾¤é—®é¢˜
â”‚   â””â”€â”€ èµ„æºè€—å°½å¤„ç†
â”‚
â”œâ”€â”€ 11.6 åº”ç”¨è°ƒè¯•æœ€ä½³å®è·µ
â”‚   â”œâ”€â”€ æ—¥å¿—æœ€ä½³å®è·µ
â”‚   â”œâ”€â”€ æ€§èƒ½åˆ†ææ–¹æ³•
â”‚   â”œâ”€â”€ è¿œç¨‹è°ƒè¯•æŠ€å·§
â”‚   â”œâ”€â”€ ä¸´æ—¶å®¹å™¨è°ƒè¯•
â”‚   â””â”€â”€ ç”Ÿäº§ç¯å¢ƒdebugç­–ç•¥
â”‚
â”œâ”€â”€ 11.7 æ•…éšœæ¡ˆä¾‹åˆ†æ
â”‚   â”œâ”€â”€ ç”Ÿäº§ç¯å¢ƒçœŸå®æ¡ˆä¾‹
â”‚   â”œâ”€â”€ æ ¹å› åˆ†ææ–¹æ³•
â”‚   â”œâ”€â”€ å¤ç›˜ä¸æ€»ç»“
â”‚   â””â”€â”€ é¢„é˜²æªæ–½
â”‚
â””â”€â”€ 11.8 æœ¬ç« æ€»ç»“
    â”œâ”€â”€ æ ¸å¿ƒçŸ¥è¯†å›é¡¾
    â”œâ”€â”€ è°ƒè¯•æŠ€èƒ½æ¸…å•
    â”œâ”€â”€ å¸¸è§é—®é¢˜é€ŸæŸ¥è¡¨
    â””â”€â”€ å­¦ä¹ èµ„æºæ¨è
```

## å­¦ä¹ è·¯å¾„å»ºè®®

**åˆå­¦è€…è·¯å¾„**(æŒæ¡åŸºç¡€è°ƒè¯•):
1. å…ˆå­¦ä¹ 11.1è°ƒè¯•å·¥å…·,ç†Ÿç»ƒä½¿ç”¨kubectlå‘½ä»¤
2. å®è·µ11.2 Podæ•…éšœæ’æŸ¥,ç†è§£å¸¸è§é”™è¯¯
3. å­¦ä¹ 11.3åŸºç¡€ç½‘ç»œè°ƒè¯•
4. æŒæ¡11.6æ—¥å¿—åˆ†ææŠ€å·§

**è¿›é˜¶è·¯å¾„**(ç‹¬ç«‹å¤„ç†ç”Ÿäº§é—®é¢˜):
1. æ·±å…¥11.3ç½‘ç»œé—®é¢˜è¯Šæ–­
2. æŒæ¡11.4å­˜å‚¨æ•…éšœå¤„ç†
3. å­¦ä¹ 11.5èŠ‚ç‚¹å’Œé›†ç¾¤çº§æ•…éšœ
4. ç ”ç©¶11.7çœŸå®æ•…éšœæ¡ˆä¾‹

**ä¸“å®¶è·¯å¾„**(æˆä¸ºæ•…éšœæ’æŸ¥ä¸“å®¶):
1. æŒæ¡æ‰€æœ‰è°ƒè¯•å·¥å…·å’Œæ–¹æ³•
2. èƒ½å¤Ÿç¼–å†™è‡ªåŠ¨åŒ–è¯Šæ–­è„šæœ¬
3. å»ºç«‹ç³»ç»ŸåŒ–çš„æ•…éšœçŸ¥è¯†åº“
4. åˆ¶å®šé¢„é˜²æ€§ç»´æŠ¤ç­–ç•¥

---

**å‡†å¤‡å¥½äº†å—?** è®©æˆ‘ä»¬å¼€å§‹å­¦ä¹ Kubernetesçš„è°ƒè¯•å·¥å…·å’Œæ•…éšœæ’æŸ¥æ–¹æ³•è®º!

---

## 11.1 è°ƒè¯•å·¥å…·ä¸æ–¹æ³•è®º

### 11.1.1 ç³»ç»ŸåŒ–æ•…éšœæ’æŸ¥æµç¨‹

#### æ•…éšœæ’æŸ¥æ–¹æ³•è®º

åœ¨Kubernetesç¯å¢ƒä¸­,æ•…éšœæ’æŸ¥éœ€è¦éµå¾ªç³»ç»ŸåŒ–çš„æ–¹æ³•è®ºã€‚ç›²ç›®å°è¯•æˆ–å‡­ç›´è§‰çŒœæµ‹å¾€å¾€ä¼šæµªè´¹å¤§é‡æ—¶é—´ã€‚ä»¥ä¸‹æ˜¯è¡Œä¹‹æœ‰æ•ˆçš„æ•…éšœæ’æŸ¥æ¡†æ¶:

**1. USEæ–¹æ³• (Utilization, Saturation, Errors)**

ç”±æ€§èƒ½åˆ†æä¸“å®¶Brendan Greggæå‡º,é€‚ç”¨äºèµ„æºåˆ†æ:

```yaml
USEæ–¹æ³•åˆ†ææ¡†æ¶:

Utilization (åˆ©ç”¨ç‡):
  å«ä¹‰: èµ„æºè¢«ä½¿ç”¨çš„ç™¾åˆ†æ¯”
  å…³é”®æŒ‡æ ‡:
    - CPUåˆ©ç”¨ç‡: å½“å‰ä½¿ç”¨/æ€»å®¹é‡
    - å†…å­˜åˆ©ç”¨ç‡: å·²ç”¨å†…å­˜/æ€»å†…å­˜
    - ç£ç›˜åˆ©ç”¨ç‡: å·²ç”¨ç©ºé—´/æ€»ç©ºé—´
    - ç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡: å½“å‰æµé‡/æ¥å£å¸¦å®½
  
  æ­£å¸¸èŒƒå›´:
    - CPU: <70% (ç•™30%ä½™é‡åº”å¯¹çªå‘)
    - Memory: <80% (é¿å…OOM)
    - Disk: <85% (é¿å…ç£ç›˜æ»¡)
    - Network: <60% (é¿å…æ‹¥å¡)

Saturation (é¥±å’Œåº¦):
  å«ä¹‰: èµ„æºæ— æ³•æ»¡è¶³è¯·æ±‚çš„ç¨‹åº¦
  å…³é”®æŒ‡æ ‡:
    - CPU run queueé•¿åº¦ (ç­‰å¾…è°ƒåº¦çš„çº¿ç¨‹æ•°)
    - Swapä½¿ç”¨é‡ (å†…å­˜ä¸è¶³å¯¼è‡´)
    - ç£ç›˜IOç­‰å¾…æ—¶é—´
    - ç½‘ç»œä¸¢åŒ…ç‡
  
  å‘Šè­¦é˜ˆå€¼:
    - Run queue > CPUæ ¸æ•° * 2
    - Swap > 0 (ç”Ÿäº§ç¯å¢ƒåº”ç¦ç”¨swap)
    - IO wait > 20%
    - Packet loss > 1%

Errors (é”™è¯¯):
  å«ä¹‰: æ˜ç¡®çš„é”™è¯¯äº‹ä»¶
  å…³é”®æ¥æº:
    - ç³»ç»Ÿæ—¥å¿— (dmesg, /var/log/messages)
    - åº”ç”¨æ—¥å¿— (kubectl logs)
    - Kubernetes Events (kubectl get events)
    - ç›‘æ§å‘Šè­¦ (Prometheus Alerts)
```

**å®æˆ˜ç¤ºä¾‹ - ä½¿ç”¨USEæ–¹æ³•è¯Šæ–­èŠ‚ç‚¹é—®é¢˜**:

```bash
# 1. Utilization - æ£€æŸ¥èµ„æºåˆ©ç”¨ç‡
kubectl top node node-1
# è¾“å‡ºç¤ºä¾‹:
# NAME     CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%
# node-1   3800m        95%    28Gi            92%
# åˆ†æ: CPU 95%, Memory 92% - èµ„æºä¸¥é‡ä¸è¶³!

# 2. Saturation - æ£€æŸ¥é¥±å’Œåº¦
kubectl describe node node-1 | grep -A 5 "Allocated resources"
# è¾“å‡ºç¤ºä¾‹:
#   Resource           Requests     Limits
#   --------           --------     ------
#   cpu                3900m (97%)  7800m (195%)
#   memory             30Gi (98%)   45Gi (147%)
# åˆ†æ: Requestsæ¥è¿‘100%,Limitsè¶…é¢åˆ†é… - å­˜åœ¨èµ„æºç«äº‰!

# ç™»å½•èŠ‚ç‚¹æ£€æŸ¥ç³»ç»Ÿçº§é¥±å’Œåº¦
ssh node-1
# æ£€æŸ¥CPUé˜Ÿåˆ—é•¿åº¦
vmstat 1 5
# procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
#  r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
#  8  2      0  1.2G   245M  15.3G    0    0    12   156  234  456 85 12  0  3  0
# åˆ†æ: r=8 (ç­‰å¾…CPUçš„è¿›ç¨‹æ•°) > CPUæ ¸æ•°4 - CPUé¥±å’Œ!
#       b=2 (ç­‰å¾…IOçš„è¿›ç¨‹æ•°) - å­˜åœ¨IOé˜»å¡

# 3. Errors - æ£€æŸ¥é”™è¯¯æ—¥å¿—
kubectl get events --field-selector involvedObject.name=node-1,type=Warning
# ç¤ºä¾‹è¾“å‡º:
# LAST SEEN   TYPE      REASON            OBJECT    MESSAGE
# 2m ago      Warning   FrequentKubeletRestart   Node   Kubelet restarted 3 times in 10 minutes
# 5m ago      Warning   SystemOOM         Node   System OOM encountered, victim process: java

# æ£€æŸ¥Podé©±é€äº‹ä»¶
kubectl get pods -o wide | grep node-1
kubectl describe pod <pod-name> | grep -A 5 "Events:"
```

**2. REDæ–¹æ³• (Rate, Errors, Duration)**

é€‚ç”¨äºæœåŠ¡è¯·æ±‚åˆ†æ:

```yaml
REDæ–¹æ³•åˆ†ææ¡†æ¶:

Rate (è¯·æ±‚é€Ÿç‡):
  å«ä¹‰: å•ä½æ—¶é—´å†…çš„è¯·æ±‚æ•°é‡
  å…³é”®æŒ‡æ ‡:
    - HTTPè¯·æ±‚QPS (Queries Per Second)
    - gRPCè°ƒç”¨RPS (Requests Per Second)
    - æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆè´¹é€Ÿç‡
  
  ç›‘æ§ç»´åº¦:
    - æŒ‰ç«¯ç‚¹åˆ†ç»„ (GET /api/users, POST /api/orders)
    - æŒ‰çŠ¶æ€ç åˆ†ç»„ (2xx, 4xx, 5xx)
    - æŒ‰æ¥æºåˆ†ç»„ (å®¢æˆ·ç«¯IP, User-Agent)

Errors (é”™è¯¯ç‡):
  å«ä¹‰: å¤±è´¥è¯·æ±‚å æ€»è¯·æ±‚çš„æ¯”ä¾‹
  å…³é”®æŒ‡æ ‡:
    - HTTP 5xxé”™è¯¯ç‡
    - è¶…æ—¶ç‡
    - è¿æ¥å¤±è´¥ç‡
  
  å‘Šè­¦é˜ˆå€¼:
    - é”™è¯¯ç‡ > 1% (99% SLO)
    - é”™è¯¯ç‡ > 0.1% (99.9% SLO)

Duration (å»¶è¿Ÿ):
  å«ä¹‰: è¯·æ±‚å¤„ç†æ—¶é—´
  å…³é”®æŒ‡æ ‡:
    - P50å»¶è¿Ÿ (ä¸­ä½æ•°)
    - P95å»¶è¿Ÿ (95%è¯·æ±‚)
    - P99å»¶è¿Ÿ (99%è¯·æ±‚)
  
  SLAç¤ºä¾‹:
    - P50 < 100ms
    - P95 < 500ms
    - P99 < 1s
```

**å®æˆ˜ç¤ºä¾‹ - ä½¿ç”¨REDæ–¹æ³•è¯Šæ–­æœåŠ¡é—®é¢˜**:

```bash
# å‰æ: åº”ç”¨å·²é›†æˆPrometheus client,æš´éœ²metrics
# è®¿é—®åº”ç”¨çš„/metricsç«¯ç‚¹

# 1. Rate - æ£€æŸ¥è¯·æ±‚é€Ÿç‡
# PromQLæŸ¥è¯¢:
rate(http_requests_total{job="api-server"}[5m])
# æŒ‰ç«¯ç‚¹åˆ†ç»„:
sum(rate(http_requests_total[5m])) by (endpoint)

# 2. Errors - æ£€æŸ¥é”™è¯¯ç‡
# HTTP 5xxé”™è¯¯ç‡:
sum(rate(http_requests_total{status=~"5.."}[5m])) 
  / 
sum(rate(http_requests_total[5m]))

# æŒ‰ç«¯ç‚¹æŸ¥çœ‹é”™è¯¯ç‡:
sum(rate(http_requests_total{status=~"5.."}[5m])) by (endpoint)
  /
sum(rate(http_requests_total[5m])) by (endpoint)

# 3. Duration - æ£€æŸ¥å»¶è¿Ÿ
# P95å»¶è¿Ÿ:
histogram_quantile(0.95, 
  sum(rate(http_request_duration_seconds_bucket[5m])) by (le, endpoint)
)

# P99å»¶è¿Ÿ:
histogram_quantile(0.99, 
  sum(rate(http_request_duration_seconds_bucket[5m])) by (le)
)

# åœ¨Grafanaä¸­å¯è§†åŒ–:
# - åˆ›å»ºä»ªè¡¨ç›˜,æ·»åŠ 3ä¸ªé¢æ¿åˆ†åˆ«æ˜¾ç¤ºRate/Errors/Duration
# - è®¾ç½®å‘Šè­¦è§„åˆ™: é”™è¯¯ç‡>1%, P99å»¶è¿Ÿ>1s
```

**3. The Four Golden Signals (Google SRE)**

Googleæå‡ºçš„æœåŠ¡ç›‘æ§å››å¤§é»„é‡‘æŒ‡æ ‡:

```yaml
å››å¤§é»„é‡‘æŒ‡æ ‡:

1. Latency (å»¶è¿Ÿ):
   å®šä¹‰: æœåŠ¡å“åº”è¯·æ±‚æ‰€éœ€çš„æ—¶é—´
   åŒºåˆ†:
     - æˆåŠŸè¯·æ±‚çš„å»¶è¿Ÿ
     - å¤±è´¥è¯·æ±‚çš„å»¶è¿Ÿ (é€šå¸¸æ›´å¿«,å› ä¸ºç›´æ¥è¿”å›é”™è¯¯)
   
   ç›‘æ§:
     - P50/P90/P95/P99å»¶è¿Ÿ
     - æŒ‰ç«¯ç‚¹/ç”¨æˆ·/åœ°åŸŸåˆ†ç»„

2. Traffic (æµé‡):
   å®šä¹‰: ç³»ç»Ÿæ‰¿å—çš„è¯·æ±‚é‡
   æŒ‡æ ‡:
     - HTTP: æ¯ç§’è¯·æ±‚æ•° (RPS)
     - æ•°æ®åº“: æ¯ç§’æŸ¥è¯¢æ•° (QPS)
     - æ¶ˆæ¯é˜Ÿåˆ—: æ¯ç§’æ¶ˆæ¯æ•°
   
   ç”¨é€”:
     - å®¹é‡è§„åˆ’
     - æ£€æµ‹æµé‡å¼‚å¸¸ (DDoSæ”»å‡»)

3. Errors (é”™è¯¯):
   å®šä¹‰: å¤±è´¥è¯·æ±‚çš„æ¯”ç‡
   åˆ†ç±»:
     - æ˜¾å¼é”™è¯¯: HTTP 500, gRPC INTERNAL
     - éšå¼é”™è¯¯: HTTP 200ä½†è¿”å›é”™è¯¯æ•°æ®
     - ç­–ç•¥é”™è¯¯: å› ç­–ç•¥è¢«æ‹’ç»çš„è¯·æ±‚
   
   å‘Šè­¦:
     - é”™è¯¯ç‡ > é˜ˆå€¼
     - é”™è¯¯æ•°ç»å¯¹å¢é•¿

4. Saturation (é¥±å’Œåº¦):
   å®šä¹‰: æœåŠ¡æˆ–èµ„æºçš„"æ»¡"ç¨‹åº¦
   æŒ‡æ ‡:
     - CPU/å†…å­˜/ç£ç›˜ä½¿ç”¨ç‡
     - çº¿ç¨‹æ± å ç”¨ç‡
     - æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ç‡
   
   é¢„æµ‹:
     - åŸºäºè¶‹åŠ¿é¢„æµ‹èµ„æºè€—å°½æ—¶é—´
     - æå‰æ‰©å®¹
```

**4. 5W1Hæ•…éšœåˆ†ææ³•**

ç³»ç»ŸåŒ–çš„é—®é¢˜æè¿°æ–¹æ³•:

```yaml
5W1Hæ•…éšœåˆ†ææ¡†æ¶:

What (ä»€ä¹ˆé—®é¢˜):
  é—®é¢˜: å…·ä½“çš„æ•…éšœç°è±¡æ˜¯ä»€ä¹ˆ?
  ç¤ºä¾‹:
    - "ç”¨æˆ·ç™»å½•æ¥å£è¿”å›504è¶…æ—¶"
    - "è®¢å•Podæ— æ³•å¯åŠ¨,ä¸€ç›´Pending"
    - "é›†ç¾¤DNSè§£æå¤±è´¥"

When (ä½•æ—¶å‘ç”Ÿ):
  é—®é¢˜: æ•…éšœä»€ä¹ˆæ—¶å€™å¼€å§‹çš„?å¤šä¹…å‘ç”Ÿä¸€æ¬¡?
  ç¤ºä¾‹:
    - "ä»Šå¤©ä¸‹åˆ3ç‚¹å¼€å§‹"
    - "æ¯å¤©å‡Œæ™¨2ç‚¹å·¦å³"
    - "é—´æ­‡æ€§å‘ç”Ÿ,æ¯å°æ—¶1-2æ¬¡"
  
  æ—¶é—´çº¿åˆ†æ:
    - æ•…éšœå‘ç”Ÿæ—¶é—´ vs ç³»ç»Ÿå˜æ›´æ—¶é—´
    - æ•…éšœå‘ç”Ÿæ—¶é—´ vs æµé‡é«˜å³°æ—¶é—´

Where (ä½•å¤„å‘ç”Ÿ):
  é—®é¢˜: æ•…éšœå½±å“å“ªäº›ç»„ä»¶/æœåŠ¡/ç”¨æˆ·?
  ç¤ºä¾‹:
    - "ä»…å½±å“node-3ä¸Šçš„Pod"
    - "ä»…å½±å“ä½äºus-weståŒºåŸŸçš„ç”¨æˆ·"
    - "æ‰€æœ‰è°ƒç”¨ç”¨æˆ·æœåŠ¡çš„æ¥å£"
  
  èŒƒå›´ç¡®å®š:
    - å…¨å±€æ•…éšœ vs å±€éƒ¨æ•…éšœ
    - ç‰¹å®šé›†ç¾¤/å‘½åç©ºé—´/èŠ‚ç‚¹

Who (è°å—å½±å“):
  é—®é¢˜: å“ªäº›ç”¨æˆ·/ç³»ç»Ÿå—åˆ°å½±å“?
  ç¤ºä¾‹:
    - "æ‰€æœ‰ç§»åŠ¨ç«¯ç”¨æˆ·"
    - "VIPå®¢æˆ·çš„è®¢å•å¤„ç†"
    - "å†…éƒ¨APIè°ƒç”¨"

Why (ä¸ºä»€ä¹ˆå‘ç”Ÿ):
  é—®é¢˜: æ ¹æœ¬åŸå› æ˜¯ä»€ä¹ˆ?
  æ–¹æ³•:
    - 5 Whysåˆ†ææ³• (è¿ç»­é—®5æ¬¡ä¸ºä»€ä¹ˆ)
    - å› æœå›¾(é±¼éª¨å›¾)
  
  ç¤ºä¾‹ (5 Whys):
    1. ä¸ºä»€ä¹ˆè®¢å•Podæ— æ³•å¯åŠ¨? 
       â†’ å› ä¸ºé•œåƒæ‹‰å–å¤±è´¥
    2. ä¸ºä»€ä¹ˆé•œåƒæ‹‰å–å¤±è´¥? 
       â†’ å› ä¸ºé•œåƒä»“åº“è¿æ¥è¶…æ—¶
    3. ä¸ºä»€ä¹ˆé•œåƒä»“åº“è¿æ¥è¶…æ—¶? 
       â†’ å› ä¸ºèŠ‚ç‚¹æ— æ³•è§£æé•œåƒä»“åº“åŸŸå
    4. ä¸ºä»€ä¹ˆæ— æ³•è§£æåŸŸå? 
       â†’ å› ä¸ºCoreDNS Podå…¨éƒ¨crash
    5. ä¸ºä»€ä¹ˆCoreDNS crash? 
       â†’ å› ä¸ºèŠ‚ç‚¹å†…å­˜è€—å°½,Podè¢«OOMKilled

How (å¦‚ä½•è§£å†³):
  é—®é¢˜: ä¸´æ—¶æ–¹æ¡ˆå’Œæ°¸ä¹…æ–¹æ¡ˆæ˜¯ä»€ä¹ˆ?
  ç¤ºä¾‹:
    ä¸´æ—¶æ–¹æ¡ˆ:
      - "é‡å¯CoreDNS Podæ¢å¤DNSæœåŠ¡"
      - "æ‰‹åŠ¨é©±é€éƒ¨åˆ†Podé‡Šæ”¾å†…å­˜"
    
    æ°¸ä¹…æ–¹æ¡ˆ:
      - "å¢åŠ CoreDNSçš„å†…å­˜é™åˆ¶"
      - "å®æ–½Podèµ„æºé…é¢,é˜²æ­¢èµ„æºè€—å°½"
      - "æ·»åŠ ç›‘æ§å‘Šè­¦,æå‰å‘ç°å†…å­˜ä¸è¶³"
```

**å®æˆ˜æ¡ˆä¾‹ - ä½¿ç”¨5W1Håˆ†æç”Ÿäº§æ•…éšœ**:

```yaml
æ•…éšœæ¡ˆä¾‹: è®¢å•æœåŠ¡å¤§é¢ç§¯è¶…æ—¶

What:
  - è®¢å•åˆ›å»ºAPIå“åº”æ—¶é—´ä»100mså¢åŠ åˆ°5ç§’
  - éƒ¨åˆ†è¯·æ±‚è¿”å›504 Gateway Timeout
  - é”™è¯¯ç‡ä»0.1%é£™å‡åˆ°15%

When:
  - å¼€å§‹æ—¶é—´: 2024-02-08 14:35
  - æŒç»­æ—¶é—´: 45åˆ†é’Ÿ
  - å˜æ›´è®°å½•: 14:30éƒ¨ç½²äº†è®¢å•æœåŠ¡v2.3.0

Where:
  - ä»…å½±å“è®¢å•æœåŠ¡ (order-service)
  - åº“å­˜æœåŠ¡ã€æ”¯ä»˜æœåŠ¡æ­£å¸¸
  - æ‰€æœ‰åœ°åŸŸçš„ç”¨æˆ·éƒ½å—å½±å“

Who:
  - æ‰€æœ‰å°è¯•ä¸‹å•çš„ç”¨æˆ·
  - å½±å“çº¦10000ä¸ªè®¢å•
  - é¢„ä¼°ä¸šåŠ¡æŸå¤±: $50000

Why (5 Whysåˆ†æ):
  1. ä¸ºä»€ä¹ˆè®¢å•æœåŠ¡è¶…æ—¶?
     â†’ å› ä¸ºæ•°æ®åº“æŸ¥è¯¢è€—æ—¶ä»10mså¢åŠ åˆ°4ç§’
  
  2. ä¸ºä»€ä¹ˆæ•°æ®åº“æŸ¥è¯¢å˜æ…¢?
     â†’ å› ä¸ºæ•°æ®åº“CPUé£™å‡åˆ°98%
  
  3. ä¸ºä»€ä¹ˆæ•°æ®åº“CPUé£™å‡?
     â†’ å› ä¸ºå‡ºç°äº†å¤§é‡å…¨è¡¨æ‰«ææŸ¥è¯¢
  
  4. ä¸ºä»€ä¹ˆå‡ºç°å…¨è¡¨æ‰«æ?
     â†’ å› ä¸ºæ–°ç‰ˆæœ¬ä»£ç ä¸­ä¸€ä¸ªæŸ¥è¯¢ç¼ºå°‘ç´¢å¼•
  
  5. ä¸ºä»€ä¹ˆç¼ºå°‘ç´¢å¼•æ²¡æœ‰åœ¨æµ‹è¯•ä¸­å‘ç°?
     â†’ å› ä¸ºæµ‹è¯•ç¯å¢ƒæ•°æ®é‡å°(1000æ¡),æ€§èƒ½æµ‹è¯•æœªè¦†ç›–

How (è§£å†³æ–¹æ¡ˆ):
  ä¸´æ—¶æ–¹æ¡ˆ (14:50æ‰§è¡Œ):
    - kubectl rollout undo deployment order-service
    - å›æ»šåˆ°v2.2.0ç‰ˆæœ¬
    - 15:20 æœåŠ¡å®Œå…¨æ¢å¤
  
  æ°¸ä¹…æ–¹æ¡ˆ:
    1. åœ¨æ•°æ®åº“æ·»åŠ ç¼ºå¤±çš„ç´¢å¼•
    2. ä¿®å¤v2.3.0ä»£ç 
    3. åœ¨é¢„å‘ç¯å¢ƒç”¨ç”Ÿäº§çº§æ•°æ®é‡è¿›è¡Œæ€§èƒ½æµ‹è¯•
    4. åˆ¶å®šæ…¢æŸ¥è¯¢ç›‘æ§å‘Šè­¦è§„åˆ™
    5. å»ºç«‹æ•°æ®åº“å˜æ›´reviewæµç¨‹

é¢„é˜²æªæ–½:
  1. ä»£ç Reviewé˜¶æ®µæ£€æŸ¥SQLæŸ¥è¯¢æ˜¯å¦æœ‰ç´¢å¼•
  2. æ€§èƒ½æµ‹è¯•ç¯å¢ƒæ•°æ®é‡æå‡åˆ°ç”Ÿäº§çº§åˆ«
  3. æ·»åŠ æ•°æ®åº“æ…¢æŸ¥è¯¢ç›‘æ§ (>100ms)
  4. å»ºç«‹é‡‘ä¸é›€å‘å¸ƒæµç¨‹,é€æ­¥æ”¾é‡
  5. åˆ¶å®šå¿«é€Ÿå›æ»šSOP (æ ‡å‡†æ“ä½œæµç¨‹)
```

#### æ•…éšœæ’æŸ¥é€šç”¨æµç¨‹

ä»¥ä¸‹æ˜¯ç»è¿‡ç”Ÿäº§éªŒè¯çš„ç³»ç»ŸåŒ–æ•…éšœæ’æŸ¥æµç¨‹:

```yaml
æ•…éšœæ’æŸ¥å…­æ­¥æ³•:

æ­¥éª¤1: ç°è±¡ç¡®è®¤ (5åˆ†é’Ÿå†…å®Œæˆ)
  ç›®æ ‡: å¿«é€Ÿäº†è§£æ•…éšœå…¨è²Œ
  è¡ŒåŠ¨:
    - æ”¶é›†ç”¨æˆ·æŠ¥å‘Šçš„é”™è¯¯ä¿¡æ¯
    - æ£€æŸ¥ç›‘æ§ç³»ç»Ÿå‘Šè­¦ (Prometheus/Grafana)
    - æŸ¥çœ‹è¿‘æœŸKubernetes Events
    - ç¡®è®¤æ•…éšœå½±å“èŒƒå›´å’Œä¸¥é‡ç¨‹åº¦
  
  å‘½ä»¤:
    # æ£€æŸ¥æœ€è¿‘çš„å‘Šè­¦
    kubectl get events --sort-by='.lastTimestamp' | head -20
    
    # æ£€æŸ¥å¼‚å¸¸Pod
    kubectl get pods --all-namespaces --field-selector status.phase!=Running
    
    # æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€
    kubectl get nodes
    
    # æŸ¥çœ‹å…³é”®ç»„ä»¶çŠ¶æ€
    kubectl get pods -n kube-system

æ­¥éª¤2: ä¿¡æ¯æ”¶é›† (10-15åˆ†é’Ÿ)
  ç›®æ ‡: æ”¶é›†è¶³å¤Ÿçš„è¯Šæ–­ä¿¡æ¯
  è¡ŒåŠ¨:
    - æ”¶é›†Podæ—¥å¿— (stdout/stderr)
    - æ”¶é›†Previouså®¹å™¨æ—¥å¿— (crashåœºæ™¯)
    - æ”¶é›†ç³»ç»Ÿæ—¥å¿— (kubelet/docker)
    - å¯¼å‡ºèµ„æºå¯¹è±¡å®šä¹‰ (YAML)
    - è®°å½•æ—¶é—´çº¿ (ä½•æ—¶å¼€å§‹ã€æŒç»­æ—¶é—´ã€å˜æ›´è®°å½•)
  
  å‘½ä»¤:
    # Podå½“å‰æ—¥å¿—
    kubectl logs <pod-name> -c <container-name> --tail=100
    
    # Podå´©æºƒå‰æ—¥å¿—
    kubectl logs <pod-name> -c <container-name> --previous
    
    # å¯¼å‡ºPodå®šä¹‰
    kubectl get pod <pod-name> -o yaml > pod-debug.yaml
    
    # æŸ¥çœ‹è¯¦ç»†æè¿°
    kubectl describe pod <pod-name>
    
    # èŠ‚ç‚¹ç³»ç»Ÿæ—¥å¿—
    ssh <node> journalctl -u kubelet -n 100

æ­¥éª¤3: é—®é¢˜å®šä½ (20-30åˆ†é’Ÿ)
  ç›®æ ‡: æ‰¾åˆ°æ•…éšœçš„æ ¹æœ¬åŸå› 
  è¡ŒåŠ¨:
    - åˆ†ææ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
    - æ£€æŸ¥èµ„æºé…ç½®æ˜¯å¦åˆç†
    - éªŒè¯ç½‘ç»œ/å­˜å‚¨è¿é€šæ€§
    - å¯¹æ¯”æ­£å¸¸å’Œå¼‚å¸¸Podçš„å·®å¼‚
    - ä½¿ç”¨æ’é™¤æ³•ç¼©å°é—®é¢˜èŒƒå›´
  
  æŠ€å·§:
    # æ¯”è¾ƒæ­£å¸¸å’Œå¼‚å¸¸Podå·®å¼‚
    kubectl diff <(kubectl get pod normal-pod -o yaml) <(kubectl get pod failed-pod -o yaml)
    
    # æ£€æŸ¥Podè°ƒåº¦åˆ°å“ªä¸ªèŠ‚ç‚¹
    kubectl get pod <pod-name> -o wide
    
    # æ£€æŸ¥èŠ‚ç‚¹èµ„æºæ˜¯å¦å……è¶³
    kubectl describe node <node-name> | grep -A 5 "Allocated resources"
    
    # è¿›å…¥Podå†…éƒ¨æ’æŸ¥
    kubectl exec -it <pod-name> -- /bin/sh

æ­¥éª¤4: å‡è®¾éªŒè¯ (æ ¹æ®å¤æ‚åº¦)
  ç›®æ ‡: éªŒè¯é—®é¢˜å‡è®¾æ˜¯å¦æ­£ç¡®
  è¡ŒåŠ¨:
    - æå‡ºå¯èƒ½çš„æ•…éšœåŸå› å‡è®¾
    - è®¾è®¡éªŒè¯å®éªŒ
    - æ‰§è¡ŒéªŒè¯å¹¶è®°å½•ç»“æœ
    - æ’é™¤é”™è¯¯å‡è®¾,èšç„¦æ­£ç¡®æ–¹å‘
  
  ç¤ºä¾‹:
    å‡è®¾1: Podå› å†…å­˜ä¸è¶³è¢«Kill
    éªŒè¯: 
      - kubectl describe pod | grep -i "OOMKilled"
      - æ£€æŸ¥ç›‘æ§ç³»ç»Ÿçš„å†…å­˜æ›²çº¿
    ç»“æœ: âœ… ç¡®è®¤æ˜¯OOMå¯¼è‡´
    
    å‡è®¾2: Serviceæ— æ³•è®¿é—®æ˜¯DNSé—®é¢˜
    éªŒè¯:
      - kubectl run test --image=busybox -it --rm -- nslookup my-service
    ç»“æœ: âŒ DNSè§£ææ­£å¸¸,æ’é™¤æ­¤å‡è®¾

æ­¥éª¤5: é—®é¢˜è§£å†³ (æ ¹æ®æ–¹æ¡ˆ)
  ç›®æ ‡: æ¢å¤æœåŠ¡æ­£å¸¸è¿è¡Œ
  åŸåˆ™:
    - ä¼˜å…ˆæ¢å¤ä¸šåŠ¡,å†åˆ†ææ ¹å› 
    - ä¸´æ—¶æ–¹æ¡ˆ + æ°¸ä¹…æ–¹æ¡ˆç»“åˆ
    - è®°å½•æ‰€æœ‰æ“ä½œæ­¥éª¤
  
  ä¸´æ—¶æ–¹æ¡ˆç¤ºä¾‹:
    - é‡å¯Pod: kubectl delete pod <pod-name>
    - æ‰©å®¹å‰¯æœ¬: kubectl scale deployment <name> --replicas=5
    - å›æ»šç‰ˆæœ¬: kubectl rollout undo deployment <name>
    - æ¸…ç†èµ„æº: kubectl delete pod <pod-name> --grace-period=0 --force
  
  æ°¸ä¹…æ–¹æ¡ˆç¤ºä¾‹:
    - ä¿®æ”¹èµ„æºé™åˆ¶
    - ä¿®å¤åº”ç”¨ä»£ç 
    - è°ƒæ•´é…ç½®å‚æ•°
    - å¢åŠ ç›‘æ§å‘Šè­¦

æ­¥éª¤6: æ€»ç»“å¤ç›˜ (äº‹å)
  ç›®æ ‡: ä»æ•…éšœä¸­å­¦ä¹ ,é˜²æ­¢å†æ¬¡å‘ç”Ÿ
  è¡ŒåŠ¨:
    - æ’°å†™æ•…éšœæŠ¥å‘Š (RCA - Root Cause Analysis)
    - æ€»ç»“ç»éªŒæ•™è®­
    - åˆ¶å®šé¢„é˜²æªæ–½
    - æ›´æ–°è¿ç»´æ–‡æ¡£
    - å›¢é˜Ÿåˆ†äº«
  
  æ•…éšœæŠ¥å‘Šæ¨¡æ¿:
    1. æ•…éšœæ‘˜è¦ (What happened)
    2. å½±å“èŒƒå›´ (Impact)
    3. æ ¹æœ¬åŸå›  (Root Cause)
    4. æ—¶é—´çº¿ (Timeline)
    5. è§£å†³æ–¹æ¡ˆ (Resolution)
    6. é¢„é˜²æªæ–½ (Prevention)
    7. è¡ŒåŠ¨é¡¹ (Action Items)
```

**æ•…éšœä¸¥é‡çº§åˆ«å®šä¹‰**:

```yaml
P0 - ä¸¥é‡æ•…éšœ (Critical):
  å®šä¹‰: æ ¸å¿ƒä¸šåŠ¡å®Œå…¨ä¸­æ–­
  ç¤ºä¾‹:
    - ç”Ÿäº§ç¯å¢ƒå…¨ç«™downæœº
    - æ”¯ä»˜ç³»ç»Ÿæ— æ³•ä½¿ç”¨
    - æ•°æ®ä¸¢å¤±æˆ–æŸå
  
  å“åº”æ—¶é—´: ç«‹å³ (5åˆ†é’Ÿå†…)
  è§£å†³æ—¶é—´: < 1å°æ—¶
  å‡çº§ç­–ç•¥: ç«‹å³å¬é›†æ‰€æœ‰ç›¸å…³äººå‘˜
  
  å¤„ç†åŸåˆ™:
    - æ‰€æœ‰äººhands-on deck
    - ä¼˜å…ˆæ¢å¤æœåŠ¡,æš‚åœæ‰€æœ‰å˜æ›´
    - æ¯15åˆ†é’ŸåŒæ­¥è¿›å±•
    - CEO/CTOéœ€è¦çŸ¥æ™“

P1 - é«˜ä¼˜å…ˆçº§æ•…éšœ (High):
  å®šä¹‰: æ ¸å¿ƒåŠŸèƒ½å—æŸ,éƒ¨åˆ†ç”¨æˆ·å—å½±å“
  ç¤ºä¾‹:
    - ç™»å½•æˆåŠŸç‡ä¸‹é™50%
    - å…³é”®APIé”™è¯¯ç‡>5%
    - ä¸»è¦åŠŸèƒ½å“åº”æ…¢
  
  å“åº”æ—¶é—´: 15åˆ†é’Ÿå†…
  è§£å†³æ—¶é—´: < 4å°æ—¶
  å‡çº§ç­–ç•¥: On-callå·¥ç¨‹å¸ˆç«‹å³å“åº”
  
  å¤„ç†åŸåˆ™:
    - On-callå·¥ç¨‹å¸ˆä¸»å¯¼
    - éœ€è¦å‘ç®¡ç†å±‚é€šæŠ¥
    - æ¯å°æ—¶æ›´æ–°è¿›å±•

P2 - ä¸­ç­‰ä¼˜å…ˆçº§ (Medium):
  å®šä¹‰: éæ ¸å¿ƒåŠŸèƒ½å¼‚å¸¸,å½±å“æœ‰é™
  ç¤ºä¾‹:
    - éå…³é”®åŠŸèƒ½æŠ¥é”™
    - éƒ¨åˆ†åœ°åŒºç”¨æˆ·å—å½±å“
    - æ€§èƒ½è½»å¾®ä¸‹é™
  
  å“åº”æ—¶é—´: 1å°æ—¶å†…
  è§£å†³æ—¶é—´: < 8å°æ—¶
  
  å¤„ç†åŸåˆ™:
    - å·¥ä½œæ—¶é—´å†…è§£å†³
    - è®°å½•è¯¦ç»†ä¿¡æ¯ä¾›åç»­åˆ†æ

P3 - ä½ä¼˜å…ˆçº§ (Low):
  å®šä¹‰: è½»å¾®é—®é¢˜,ä¸å½±å“ç”¨æˆ·
  ç¤ºä¾‹:
    - å‘Šè­¦è¯¯æŠ¥
    - éç”Ÿäº§ç¯å¢ƒé—®é¢˜
    - ä¼˜åŒ–å»ºè®®
  
  å“åº”æ—¶é—´: å·¥ä½œæ—¶é—´å†…
  è§£å†³æ—¶é—´: æ ¹æ®æ’æœŸ
  
  å¤„ç†åŸåˆ™:
    - çº³å…¥å¸¸è§„å·¥ä½œæµ
    - å®šæœŸreviewå’Œå¤„ç†
```

### 11.1.2 kubectlæ ¸å¿ƒè°ƒè¯•å‘½ä»¤

#### kubectlè°ƒè¯•å‘½ä»¤åˆ†ç±»

kubectlæä¾›äº†ä¸°å¯Œçš„è°ƒè¯•å‘½ä»¤,æŒæ¡è¿™äº›å‘½ä»¤æ˜¯Kubernetesæ•…éšœæ’æŸ¥çš„åŸºç¡€:

**1. èµ„æºæŸ¥çœ‹å‘½ä»¤**

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl get - åˆ—å‡ºèµ„æº
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹æ‰€æœ‰Pod (ç®€æ´è§†å›¾)
kubectl get pods

# æŸ¥çœ‹æ‰€æœ‰Pod (å®½è§†å›¾,æ˜¾ç¤ºIPå’ŒèŠ‚ç‚¹)
kubectl get pods -o wide

# æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´çš„Pod
kubectl get pods --all-namespaces
# æˆ–ç®€å†™
kubectl get pods -A

# æŸ¥çœ‹Podè¯¦ç»†ä¿¡æ¯ (YAMLæ ¼å¼)
kubectl get pod <pod-name> -o yaml

# æŸ¥çœ‹Podè¯¦ç»†ä¿¡æ¯ (JSONæ ¼å¼)
kubectl get pod <pod-name> -o json

# ä½¿ç”¨JSONPathæå–ç‰¹å®šå­—æ®µ
kubectl get pod <pod-name> -o jsonpath='{.status.podIP}'
kubectl get pod <pod-name> -o jsonpath='{.spec.containers[*].name}'

# è‡ªå®šä¹‰åˆ—æ˜¾ç¤º
kubectl get pods -o custom-columns=\
NAME:.metadata.name,\
STATUS:.status.phase,\
NODE:.spec.nodeName,\
IP:.status.podIP

# æŒ‰æ ‡ç­¾é€‰æ‹©
kubectl get pods -l app=nginx
kubectl get pods -l 'app in (nginx,apache)'
kubectl get pods -l app=nginx,env=prod

# æŒ‰å­—æ®µé€‰æ‹©
kubectl get pods --field-selector status.phase=Running
kubectl get pods --field-selector spec.nodeName=node-1

# æ’åºè¾“å‡º
kubectl get pods --sort-by='.status.startTime'
kubectl get pods --sort-by='.metadata.creationTimestamp'

# ç›‘å¬èµ„æºå˜åŒ– (watchæ¨¡å¼)
kubectl get pods -w
kubectl get pods -w -o wide

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl describe - æŸ¥çœ‹èµ„æºè¯¦ç»†ä¿¡æ¯
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹Podè¯¦ç»†ä¿¡æ¯ (äººç±»å¯è¯»æ ¼å¼)
kubectl describe pod <pod-name>

# describeè¾“å‡ºåŒ…å«:
# - åŸºæœ¬ä¿¡æ¯: Name, Namespace, Node, Labels, Annotations
# - çŠ¶æ€ä¿¡æ¯: Status, IP, Controlled By
# - å®¹å™¨ä¿¡æ¯: Image, Ports, Resources, Environment
# - æ¡ä»¶ä¿¡æ¯: Initialized, Ready, ContainersReady, PodScheduled
# - å·æŒ‚è½½: Volumes, Mounts
# - QoSç±»: Guaranteed/Burstable/BestEffort
# - äº‹ä»¶: Events (æœ€è¿‘çš„Podäº‹ä»¶,éå¸¸é‡è¦!)

# æŸ¥çœ‹Nodeè¯¦ç»†ä¿¡æ¯
kubectl describe node <node-name>
# è¾“å‡ºåŒ…å«:
# - èŠ‚ç‚¹æ ‡ç­¾å’Œæ±¡ç‚¹
# - ç³»ç»Ÿä¿¡æ¯: OS, Kernel, Container Runtime
# - èµ„æºå®¹é‡å’Œå¯åˆ†é…èµ„æº
# - å·²åˆ†é…èµ„æºç»Ÿè®¡
# - Podåˆ—è¡¨
# - èŠ‚ç‚¹äº‹ä»¶

# æŸ¥çœ‹Serviceè¯¦ç»†ä¿¡æ¯
kubectl describe service <service-name>
# è¾“å‡ºåŒ…å«:
# - Serviceç±»å‹ (ClusterIP/NodePort/LoadBalancer)
# - ClusterIPå’Œç«¯å£
# - Endpoints (åç«¯Pod IPåˆ—è¡¨)
# - Session Affinity
# - Events

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl top - æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# å‰æ: éœ€è¦éƒ¨ç½²metrics-server

# æŸ¥çœ‹èŠ‚ç‚¹èµ„æºä½¿ç”¨
kubectl top node
# è¾“å‡ºç¤ºä¾‹:
# NAME     CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%
# node-1   850m         21%    4096Mi          52%
# node-2   1200m        30%    6144Mi          78%

# æŸ¥çœ‹Podèµ„æºä½¿ç”¨
kubectl top pod
kubectl top pod -n kube-system
kubectl top pod --all-namespaces

# æŒ‰èµ„æºæ’åº
kubectl top pod --sort-by=cpu
kubectl top pod --sort-by=memory

# æŸ¥çœ‹Podä¸­å„å®¹å™¨çš„èµ„æºä½¿ç”¨
kubectl top pod <pod-name> --containers

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl events - æŸ¥çœ‹äº‹ä»¶
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹æ‰€æœ‰äº‹ä»¶
kubectl get events

# æŒ‰æ—¶é—´æ’åº (æœ€æ–°çš„åœ¨å‰)
kubectl get events --sort-by='.lastTimestamp'

# æŸ¥çœ‹ç‰¹å®šèµ„æºçš„äº‹ä»¶
kubectl get events --field-selector involvedObject.name=<pod-name>

# æŸ¥çœ‹ç‰¹å®šç±»å‹çš„äº‹ä»¶
kubectl get events --field-selector type=Warning
kubectl get events --field-selector type=Normal

# æŸ¥çœ‹ç‰¹å®šå‘½åç©ºé—´çš„äº‹ä»¶
kubectl get events -n kube-system

# ç›‘å¬æ–°äº‹ä»¶
kubectl get events -w

# æŸ¥çœ‹äº‹ä»¶è¯¦ç»†ä¿¡æ¯
kubectl describe event <event-name>

**2. æ—¥å¿—æŸ¥çœ‹å‘½ä»¤**

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl logs - æŸ¥çœ‹å®¹å™¨æ—¥å¿—
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹Podæ—¥å¿— (å•å®¹å™¨Pod)
kubectl logs <pod-name>

# æŸ¥çœ‹Podä¸­ç‰¹å®šå®¹å™¨çš„æ—¥å¿— (å¤šå®¹å™¨Pod)
kubectl logs <pod-name> -c <container-name>

# æŸ¥çœ‹æœ€è¿‘100è¡Œæ—¥å¿—
kubectl logs <pod-name> --tail=100

# æŸ¥çœ‹æœ€è¿‘1å°æ—¶çš„æ—¥å¿—
kubectl logs <pod-name> --since=1h
kubectl logs <pod-name> --since=60m

# æŸ¥çœ‹æŒ‡å®šæ—¶é—´ä¹‹åçš„æ—¥å¿—
kubectl logs <pod-name> --since-time=2024-02-08T14:00:00Z

# å®æ—¶è·Ÿè¸ªæ—¥å¿— (ç±»ä¼¼tail -f)
kubectl logs <pod-name> -f
kubectl logs <pod-name> -c <container-name> -f --tail=50

# æŸ¥çœ‹ä¹‹å‰å®¹å™¨çš„æ—¥å¿— (å®¹å™¨é‡å¯/å´©æºƒåœºæ™¯)
kubectl logs <pod-name> --previous
kubectl logs <pod-name> -c <container-name> --previous

# åœºæ™¯: å®¹å™¨åå¤é‡å¯,æŸ¥çœ‹å´©æºƒåŸå› 
kubectl logs <pod-name> -c <container-name> --previous --tail=100

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çš„æ—¥å¿— (åŒ…æ‹¬initå®¹å™¨)
kubectl logs <pod-name> --all-containers=true

# æŸ¥çœ‹initå®¹å™¨æ—¥å¿—
kubectl logs <pod-name> -c <init-container-name>

# æ·»åŠ æ—¶é—´æˆ³
kubectl logs <pod-name> --timestamps

# è¿‡æ»¤æ—¥å¿— (ç»“åˆgrep)
kubectl logs <pod-name> | grep ERROR
kubectl logs <pod-name> | grep -i "exception\|error\|fatal"

# æŸ¥çœ‹å¤šä¸ªPodçš„æ—¥å¿— (ä½¿ç”¨æ ‡ç­¾)
kubectl logs -l app=nginx --all-containers=true

# ä¿å­˜æ—¥å¿—åˆ°æ–‡ä»¶
kubectl logs <pod-name> > pod-logs.txt
kubectl logs <pod-name> --previous > pod-crash-logs.txt

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# æ—¥å¿—åˆ†ææŠ€å·§
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# 1. æŸ¥æ‰¾é”™è¯¯å…³é”®è¯
kubectl logs <pod-name> | grep -E "error|exception|fatal|panic|fail" -i

# 2. ç»Ÿè®¡é”™è¯¯å‡ºç°æ¬¡æ•°
kubectl logs <pod-name> | grep -i error | wc -l

# 3. æŸ¥æ‰¾ç‰¹å®šæ—¶é—´æ®µçš„é”™è¯¯
kubectl logs <pod-name> --since=1h | grep ERROR

# 4. æŸ¥çœ‹åº”ç”¨å¯åŠ¨æ—¥å¿— (æ£€æŸ¥å¯åŠ¨å¤±è´¥åŸå› )
kubectl logs <pod-name> --tail=200 | head -50

# 5. æŸ¥æ‰¾OOM (å†…å­˜æº¢å‡º) ç›¸å…³æ—¥å¿—
kubectl logs <pod-name> --previous | grep -i "out of memory\|oom"

# 6. æŸ¥æ‰¾è¿æ¥é”™è¯¯
kubectl logs <pod-name> | grep -i "connection refused\|timeout\|connect failed"

# 7. å¯¼å‡ºæ‰€æœ‰Podæ—¥å¿— (æ‰¹é‡æ’æŸ¥)
for pod in $(kubectl get pods -l app=nginx -o name); do
  echo "=== $pod ===" >> all-logs.txt
  kubectl logs $pod >> all-logs.txt 2>&1
done
```

**å®æˆ˜æ¡ˆä¾‹ - ä½¿ç”¨æ—¥å¿—æ’æŸ¥Podå¯åŠ¨å¤±è´¥**:

```bash
# åœºæ™¯: Podä¸€ç›´å¤„äºCrashLoopBackOffçŠ¶æ€

# 1. æŸ¥çœ‹PodçŠ¶æ€
kubectl get pod myapp-5d7f8c9b-xyz
# NAME                    READY   STATUS             RESTARTS   AGE
# myapp-5d7f8c9b-xyz      0/1     CrashLoopBackOff   5          5m

# 2. æŸ¥çœ‹å´©æºƒå‰çš„æ—¥å¿—
kubectl logs myapp-5d7f8c9b-xyz --previous --tail=50
# è¾“å‡ºç¤ºä¾‹:
# 2024-02-08T10:15:30.123Z INFO  Starting application...
# 2024-02-08T10:15:30.456Z INFO  Connecting to database mysql://db.example.com:3306
# 2024-02-08T10:15:32.789Z ERROR Failed to connect: Connection refused
# 2024-02-08T10:15:32.790Z FATAL Application failed to start
# 2024-02-08T10:15:32.790Z INFO  Exiting with code 1

# 3. åˆ†æ: åº”ç”¨æ— æ³•è¿æ¥åˆ°æ•°æ®åº“,å¯¼è‡´å¯åŠ¨å¤±è´¥

# 4. éªŒè¯æ•°æ®åº“æœåŠ¡æ˜¯å¦å­˜åœ¨
kubectl get svc mysql
# å¦‚æœä¸å­˜åœ¨,åˆ™éœ€è¦å…ˆéƒ¨ç½²æ•°æ®åº“æœåŠ¡

# 5. å¦‚æœæœåŠ¡å­˜åœ¨,æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
kubectl run test --image=mysql:8.0 -it --rm -- \
  mysql -h mysql.default.svc.cluster.local -u root -p

# 6. æ£€æŸ¥åº”ç”¨é…ç½®
kubectl get pod myapp-5d7f8c9b-xyz -o yaml | grep -A 10 env:
# æŸ¥çœ‹æ•°æ®åº“è¿æ¥é…ç½®æ˜¯å¦æ­£ç¡®
```

**3. å®¹å™¨äº¤äº’å‘½ä»¤**

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl exec - åœ¨å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# åœ¨Podä¸­æ‰§è¡Œå•ä¸ªå‘½ä»¤
kubectl exec <pod-name> -- ls -la /app

# åœ¨å¤šå®¹å™¨Podä¸­æŒ‡å®šå®¹å™¨
kubectl exec <pod-name> -c <container-name> -- ps aux

# è¿›å…¥å®¹å™¨äº¤äº’å¼shell
kubectl exec -it <pod-name> -- /bin/bash
kubectl exec -it <pod-name> -- /bin/sh  # å¦‚æœæ²¡æœ‰bash

# å¤šå®¹å™¨Podè¿›å…¥æŒ‡å®šå®¹å™¨
kubectl exec -it <pod-name> -c <container-name> -- /bin/bash

# åœ¨å®¹å™¨ä¸­æŸ¥çœ‹ç¯å¢ƒå˜é‡
kubectl exec <pod-name> -- env

# åœ¨å®¹å™¨ä¸­æµ‹è¯•ç½‘ç»œè¿é€šæ€§
kubectl exec <pod-name> -- ping 8.8.8.8
kubectl exec <pod-name> -- curl http://service-name:8080/health

# åœ¨å®¹å™¨ä¸­æ£€æŸ¥è¿›ç¨‹
kubectl exec <pod-name> -- ps aux
kubectl exec <pod-name> -- top -b -n 1

# åœ¨å®¹å™¨ä¸­æ£€æŸ¥æ–‡ä»¶
kubectl exec <pod-name> -- ls -la /var/log/
kubectl exec <pod-name> -- cat /etc/nginx/nginx.conf

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl exec å®æˆ˜æŠ€å·§
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# 1. æ£€æŸ¥å®¹å™¨å†…DNSè§£æ
kubectl exec <pod-name> -- nslookup kubernetes.default
kubectl exec <pod-name> -- cat /etc/resolv.conf

# 2. æµ‹è¯•Serviceè¿æ¥
kubectl exec <pod-name> -- curl -v http://my-service:8080

# 3. æ£€æŸ¥æŒ‚è½½çš„Volume
kubectl exec <pod-name> -- df -h
kubectl exec <pod-name> -- ls -la /mnt/data

# 4. æŸ¥çœ‹å®¹å™¨å†…æ—¥å¿—æ–‡ä»¶
kubectl exec <pod-name> -- tail -f /var/log/app.log

# 5. æ£€æŸ¥åº”ç”¨é…ç½®æ–‡ä»¶
kubectl exec <pod-name> -- cat /etc/app/config.yaml

# 6. æ’æŸ¥æ•°æ®åº“è¿æ¥é—®é¢˜
kubectl exec <pod-name> -- nc -zv mysql-service 3306

# 7. æ£€æŸ¥å®¹å™¨æ—¶åŒºé…ç½®
kubectl exec <pod-name> -- date
kubectl exec <pod-name> -- cat /etc/timezone

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl cp - å¤åˆ¶æ–‡ä»¶åˆ°/ä»å®¹å™¨
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ä»å®¹å™¨å¤åˆ¶æ–‡ä»¶åˆ°æœ¬åœ°
kubectl cp <pod-name>:/path/to/file ./local-file
kubectl cp <pod-name>:/var/log/app.log ./app.log

# ä»æœ¬åœ°å¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨
kubectl cp ./local-file <pod-name>:/path/to/file
kubectl cp ./config.yaml <pod-name>:/etc/app/config.yaml

# å¤šå®¹å™¨PodæŒ‡å®šå®¹å™¨
kubectl cp <pod-name>:/path/to/file ./local-file -c <container-name>

# å¤åˆ¶æ•´ä¸ªç›®å½•
kubectl cp <pod-name>:/var/log/ ./logs/

# åœºæ™¯: å¯¼å‡ºå®¹å™¨å†…çš„æ—¥å¿—æ–‡ä»¶åˆ°æœ¬åœ°åˆ†æ
kubectl cp myapp-pod:/var/log/application.log ./debug-logs/
```

**å®æˆ˜æ¡ˆä¾‹ - ä½¿ç”¨execæ’æŸ¥åº”ç”¨é—®é¢˜**:

```bash
# åœºæ™¯: åº”ç”¨è¿”å›500é”™è¯¯,éœ€è¦è¿›å…¥å®¹å™¨æ’æŸ¥

# 1. è¿›å…¥å®¹å™¨
kubectl exec -it myapp-5d7f8c9b-xyz -- /bin/bash

# 2. æ£€æŸ¥åº”ç”¨è¿›ç¨‹
ps aux | grep java
# ç¡®è®¤åº”ç”¨è¿›ç¨‹æ˜¯å¦è¿è¡Œ

# 3. æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tunlp | grep 8080
# æˆ–
ss -tunlp | grep 8080
# ç¡®è®¤åº”ç”¨æ˜¯å¦ç›‘å¬æ­£ç¡®ç«¯å£

# 4. æµ‹è¯•åº”ç”¨æ¥å£
curl http://localhost:8080/health
curl http://localhost:8080/api/users

# 5. æ£€æŸ¥åº”ç”¨æ—¥å¿—
tail -f /var/log/application.log
# å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—

# 6. æ£€æŸ¥é…ç½®æ–‡ä»¶
cat /etc/app/application.yaml
# ç¡®è®¤é…ç½®æ˜¯å¦æ­£ç¡®

# 7. æµ‹è¯•æ•°æ®åº“è¿æ¥
nc -zv mysql-service 3306
# å¦‚æœå®¹å™¨å†…æ²¡æœ‰nc,å°è¯•telnet:
telnet mysql-service 3306

# 8. æ£€æŸ¥ç¯å¢ƒå˜é‡
env | grep -i db
# æŸ¥çœ‹æ•°æ®åº“ç›¸å…³ç¯å¢ƒå˜é‡

# 9. æ£€æŸ¥DNSè§£æ
nslookup mysql-service
dig mysql-service

# 10. é€€å‡ºå®¹å™¨
exit
```

**4. èµ„æºç¼–è¾‘å‘½ä»¤**

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl edit - åœ¨çº¿ç¼–è¾‘èµ„æº
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ç¼–è¾‘Deployment
kubectl edit deployment <deployment-name>
# ä¼šæ‰“å¼€é»˜è®¤ç¼–è¾‘å™¨ (é€šå¸¸æ˜¯vim),ä¿®æ”¹åä¿å­˜å³ç”Ÿæ•ˆ

# ç¼–è¾‘Service
kubectl edit service <service-name>

# ç¼–è¾‘ConfigMap
kubectl edit configmap <configmap-name>

# æŒ‡å®šç¼–è¾‘å™¨
KUBE_EDITOR="nano" kubectl edit deployment <deployment-name>

# æ³¨æ„: editå‘½ä»¤ç›´æ¥ä¿®æ”¹etcdä¸­çš„èµ„æº,éœ€è°¨æ…ä½¿ç”¨

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl patch - éƒ¨åˆ†æ›´æ–°èµ„æº
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æ›´æ–°Deploymentå‰¯æœ¬æ•°
kubectl patch deployment myapp -p '{"spec":{"replicas":5}}'

# æ›´æ–°Podå®¹å™¨é•œåƒ
kubectl patch pod myapp-pod -p '{"spec":{"containers":[{"name":"myapp","image":"myapp:v2.0"}]}}'

# æ·»åŠ æ ‡ç­¾
kubectl patch pod myapp-pod -p '{"metadata":{"labels":{"version":"v2.0"}}}'

# ä½¿ç”¨JSON patch
kubectl patch deployment myapp --type='json' -p='[{"op":"replace","path":"/spec/replicas","value":3}]'

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl scale - æ‰©ç¼©å®¹
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æ‰‹åŠ¨æ‰©å®¹
kubectl scale deployment myapp --replicas=5

# ç¼©å®¹
kubectl scale deployment myapp --replicas=1

# æ‰©å®¹StatefulSet
kubectl scale statefulset mysql --replicas=3

# æ¡ä»¶æ‰©å®¹ (ä»…å½“å½“å‰å‰¯æœ¬æ•°ä¸º2æ—¶æ‰æ‰©å®¹åˆ°3)
kubectl scale deployment myapp --current-replicas=2 --replicas=3

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl set - æ›´æ–°èµ„æº
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æ›´æ–°é•œåƒ
kubectl set image deployment/myapp myapp=myapp:v2.0
kubectl set image deployment/myapp myapp=myapp:v2.0 --record

# æ›´æ–°èµ„æºé™åˆ¶
kubectl set resources deployment myapp -c=myapp --limits=cpu=500m,memory=512Mi

# æ›´æ–°ç¯å¢ƒå˜é‡
kubectl set env deployment/myapp DB_HOST=mysql.example.com

# æŸ¥çœ‹ç¯å¢ƒå˜é‡
kubectl set env deployment/myapp --list

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl rollout - ç®¡ç†å‘å¸ƒ
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹å‘å¸ƒçŠ¶æ€
kubectl rollout status deployment/myapp

# æŸ¥çœ‹å‘å¸ƒå†å²
kubectl rollout history deployment/myapp

# æŸ¥çœ‹ç‰¹å®šç‰ˆæœ¬è¯¦æƒ…
kubectl rollout history deployment/myapp --revision=2

# å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
kubectl rollout undo deployment/myapp

# å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
kubectl rollout undo deployment/myapp --to-revision=2

# æš‚åœå‘å¸ƒ (é‡‘ä¸é›€éƒ¨ç½²åœºæ™¯)
kubectl rollout pause deployment/myapp

# æ¢å¤å‘å¸ƒ
kubectl rollout resume deployment/myapp

# é‡å¯Deployment (å¼ºåˆ¶é‡å»ºæ‰€æœ‰Pod)
kubectl rollout restart deployment/myapp
```

**5. è°ƒè¯•ä¸“ç”¨å‘½ä»¤**

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl debug - ä¸´æ—¶è°ƒè¯•å®¹å™¨ (K8s 1.18+)
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# åœ¨ç°æœ‰Podä¸­åˆ›å»ºè°ƒè¯•å®¹å™¨
kubectl debug <pod-name> -it --image=busybox
kubectl debug <pod-name> -it --image=nicolaka/netshoot

# å¤åˆ¶Podå¹¶æ·»åŠ è°ƒè¯•å®¹å™¨
kubectl debug <pod-name> -it --image=busybox --copy-to=debug-pod

# å¤åˆ¶Podå¹¶ä¿®æ”¹å‘½ä»¤ (æ’æŸ¥å¯åŠ¨å¤±è´¥)
kubectl debug <pod-name> -it --copy-to=debug-pod --container=myapp -- sh

# åœ¨èŠ‚ç‚¹ä¸Šåˆ›å»ºè°ƒè¯•Pod (è®¿é—®èŠ‚ç‚¹æ–‡ä»¶ç³»ç»Ÿ)
kubectl debug node/<node-name> -it --image=ubuntu

# åœºæ™¯: Podæ— æ³•å¯åŠ¨,ä½¿ç”¨debugå®¹å™¨æ’æŸ¥
kubectl debug failing-pod -it --image=busybox --copy-to=debug-pod
# åœ¨debug-podä¸­æ‰‹åŠ¨è¿è¡Œåº”ç”¨å‘½ä»¤,æŸ¥çœ‹é”™è¯¯

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl run - ä¸´æ—¶æµ‹è¯•Pod
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# åˆ›å»ºä¸´æ—¶æµ‹è¯•Pod
kubectl run test --image=busybox -it --rm -- sh
# --rm: Podé€€å‡ºåè‡ªåŠ¨åˆ é™¤

# æµ‹è¯•DNSè§£æ
kubectl run test-dns --image=busybox -it --rm -- nslookup kubernetes.default

# æµ‹è¯•Serviceè¿é€šæ€§
kubectl run test-curl --image=curlimages/curl -it --rm -- \
  curl http://my-service:8080

# æµ‹è¯•æ•°æ®åº“è¿æ¥
kubectl run test-mysql --image=mysql:8.0 -it --rm -- \
  mysql -h mysql-service -u root -p

# ç½‘ç»œè¯Šæ–­ (ä½¿ç”¨netshootå·¥å…·é•œåƒ)
kubectl run netshoot --image=nicolaka/netshoot -it --rm -- bash
# netshootåŒ…å«: tcpdump, netstat, iperf, nmapç­‰å·¥å…·

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl port-forward - ç«¯å£è½¬å‘
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# è½¬å‘Podç«¯å£åˆ°æœ¬åœ°
kubectl port-forward <pod-name> 8080:80
# æœ¬åœ°è®¿é—®: http://localhost:8080

# è½¬å‘Serviceç«¯å£
kubectl port-forward svc/<service-name> 8080:80

# æŒ‡å®šæœ¬åœ°ç›‘å¬åœ°å€
kubectl port-forward --address 0.0.0.0 <pod-name> 8080:80
# å…è®¸å…¶ä»–æœºå™¨è®¿é—®

# å¤šç«¯å£è½¬å‘
kubectl port-forward <pod-name> 8080:80 9090:9090

# åœºæ™¯: æœ¬åœ°è°ƒè¯•Podåº”ç”¨
kubectl port-forward myapp-pod 8080:8080
# åœ¨æœ¬åœ°æµè§ˆå™¨è®¿é—® http://localhost:8080

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl proxy - APIä»£ç†
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# å¯åŠ¨APIä»£ç†æœåŠ¡å™¨
kubectl proxy --port=8001
# è®¿é—®: http://localhost:8001/api/v1/namespaces/default/pods

# è®¿é—®Podçš„metricsç«¯ç‚¹
# http://localhost:8001/api/v1/namespaces/default/pods/<pod-name>/proxy/metrics

# è®¿é—®Service
# http://localhost:8001/api/v1/namespaces/default/services/<service-name>/proxy/
```

### 11.1.3 å®¹å™¨è°ƒè¯•æŠ€å·§

#### å®¹å™¨æ— æ³•å¯åŠ¨çš„è°ƒè¯•

å½“å®¹å™¨æ— æ³•å¯åŠ¨æ—¶,éœ€è¦ç³»ç»ŸåŒ–åœ°æ’æŸ¥åŸå› :

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# åœºæ™¯1: é•œåƒæ‹‰å–å¤±è´¥ (ImagePullBackOff)
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# 1. æŸ¥çœ‹PodçŠ¶æ€
kubectl get pod myapp-pod
# STATUS: ImagePullBackOff æˆ– ErrImagePull

# 2. æŸ¥çœ‹è¯¦ç»†é”™è¯¯
kubectl describe pod myapp-pod
# Events:
#   Warning  Failed     3m    kubelet  Failed to pull image "myapp:v1.0": rpc error: code = Unknown desc = Error response from daemon: pull access denied

# å¸¸è§åŸå› :
# - é•œåƒåç§°æˆ–æ ‡ç­¾é”™è¯¯
# - é•œåƒä¸å­˜åœ¨
# - ç§æœ‰ä»“åº“è®¤è¯å¤±è´¥
# - ç½‘ç»œé—®é¢˜å¯¼è‡´æ— æ³•è®¿é—®é•œåƒä»“åº“

# 3. è§£å†³æ–¹æ¡ˆ

# æ–¹æ¡ˆA: æ£€æŸ¥é•œåƒæ˜¯å¦å­˜åœ¨
docker pull myapp:v1.0
# å¦‚æœæœ¬åœ°å¯ä»¥æ‹‰å–,åˆ™è¯´æ˜é•œåƒå­˜åœ¨

# æ–¹æ¡ˆB: åˆ›å»ºé•œåƒæ‹‰å–å¯†é’¥ (ç§æœ‰ä»“åº“)
kubectl create secret docker-registry regcred \
  --docker-server=registry.example.com \
  --docker-username=myuser \
  --docker-password=mypassword \
  --docker-email=myemail@example.com

# åœ¨Podä¸­ä½¿ç”¨å¯†é’¥
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: myapp-pod
spec:
  containers:
  - name: myapp
    image: registry.example.com/myapp:v1.0
  imagePullSecrets:
  - name: regcred  # å¼•ç”¨å¯†é’¥


**2. æ—¥å¿—æŸ¥çœ‹å‘½ä»¤**

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl logs - æŸ¥çœ‹å®¹å™¨æ—¥å¿—
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹Podæ—¥å¿— (å•å®¹å™¨Pod)
kubectl logs <pod-name>

# æŸ¥çœ‹Podä¸­ç‰¹å®šå®¹å™¨çš„æ—¥å¿— (å¤šå®¹å™¨Pod)
kubectl logs <pod-name> -c <container-name>

# æŸ¥çœ‹æœ€è¿‘100è¡Œæ—¥å¿—
kubectl logs <pod-name> --tail=100

# æŸ¥çœ‹æœ€è¿‘1å°æ—¶çš„æ—¥å¿—
kubectl logs <pod-name> --since=1h
kubectl logs <pod-name> --since=60m

# æŸ¥çœ‹æŒ‡å®šæ—¶é—´ä¹‹åçš„æ—¥å¿—
kubectl logs <pod-name> --since-time=2024-02-08T14:00:00Z

# å®æ—¶è·Ÿè¸ªæ—¥å¿— (ç±»ä¼¼tail -f)
kubectl logs <pod-name> -f
kubectl logs <pod-name> -c <container-name> -f --tail=50

# æŸ¥çœ‹ä¹‹å‰å®¹å™¨çš„æ—¥å¿— (å®¹å™¨é‡å¯/å´©æºƒåœºæ™¯)
kubectl logs <pod-name> --previous
kubectl logs <pod-name> -c <container-name> --previous

# åœºæ™¯: å®¹å™¨åå¤é‡å¯,æŸ¥çœ‹å´©æºƒåŸå› 
kubectl logs <pod-name> -c <container-name> --previous --tail=100

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çš„æ—¥å¿— (åŒ…æ‹¬initå®¹å™¨)
kubectl logs <pod-name> --all-containers=true

# æŸ¥çœ‹initå®¹å™¨æ—¥å¿—
kubectl logs <pod-name> -c <init-container-name>

# æ·»åŠ æ—¶é—´æˆ³
kubectl logs <pod-name> --timestamps

# è¿‡æ»¤æ—¥å¿— (ç»“åˆgrep)
kubectl logs <pod-name> | grep ERROR
kubectl logs <pod-name> | grep -i "exception\|error\|fatal"

# æŸ¥çœ‹å¤šä¸ªPodçš„æ—¥å¿— (ä½¿ç”¨æ ‡ç­¾)
kubectl logs -l app=nginx --all-containers=true

# ä¿å­˜æ—¥å¿—åˆ°æ–‡ä»¶
kubectl logs <pod-name> > pod-logs.txt
kubectl logs <pod-name> --previous > pod-crash-logs.txt

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# æ—¥å¿—åˆ†ææŠ€å·§
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# 1. æŸ¥æ‰¾é”™è¯¯å…³é”®è¯
kubectl logs <pod-name> | grep -E "error|exception|fatal|panic|fail" -i

# 2. ç»Ÿè®¡é”™è¯¯å‡ºç°æ¬¡æ•°
kubectl logs <pod-name> | grep -i error | wc -l

# 3. æŸ¥æ‰¾ç‰¹å®šæ—¶é—´æ®µçš„é”™è¯¯
kubectl logs <pod-name> --since=1h | grep ERROR

# 4. æŸ¥çœ‹åº”ç”¨å¯åŠ¨æ—¥å¿— (æ£€æŸ¥å¯åŠ¨å¤±è´¥åŸå› )
kubectl logs <pod-name> --tail=200 | head -50

# 5. æŸ¥æ‰¾OOM (å†…å­˜æº¢å‡º) ç›¸å…³æ—¥å¿—
kubectl logs <pod-name> --previous | grep -i "out of memory\|oom"

# 6. æŸ¥æ‰¾è¿æ¥é”™è¯¯
kubectl logs <pod-name> | grep -i "connection refused\|timeout\|connect failed"

# 7. å¯¼å‡ºæ‰€æœ‰Podæ—¥å¿— (æ‰¹é‡æ’æŸ¥)
for pod in $(kubectl get pods -l app=nginx -o name); do
  echo "=== $pod ===" >> all-logs.txt
  kubectl logs $pod >> all-logs.txt 2>&1
done
```

**å®æˆ˜æ¡ˆä¾‹ - ä½¿ç”¨æ—¥å¿—æ’æŸ¥Podå¯åŠ¨å¤±è´¥**:

```bash
# åœºæ™¯: Podä¸€ç›´å¤„äºCrashLoopBackOffçŠ¶æ€

# 1. æŸ¥çœ‹PodçŠ¶æ€
kubectl get pod myapp-5d7f8c9b-xyz
# NAME                    READY   STATUS             RESTARTS   AGE
# myapp-5d7f8c9b-xyz      0/1     CrashLoopBackOff   5          5m

# 2. æŸ¥çœ‹å´©æºƒå‰çš„æ—¥å¿—
kubectl logs myapp-5d7f8c9b-xyz --previous --tail=50
# è¾“å‡ºç¤ºä¾‹:
# 2024-02-08T10:15:30.123Z INFO  Starting application...
# 2024-02-08T10:15:30.456Z INFO  Connecting to database mysql://db.example.com:3306
# 2024-02-08T10:15:32.789Z ERROR Failed to connect: Connection refused
# 2024-02-08T10:15:32.790Z FATAL Application failed to start
# 2024-02-08T10:15:32.790Z INFO  Exiting with code 1

# 3. åˆ†æ: åº”ç”¨æ— æ³•è¿æ¥åˆ°æ•°æ®åº“,å¯¼è‡´å¯åŠ¨å¤±è´¥

# 4. éªŒè¯æ•°æ®åº“æœåŠ¡æ˜¯å¦å­˜åœ¨
kubectl get svc mysql
# å¦‚æœä¸å­˜åœ¨,åˆ™éœ€è¦å…ˆéƒ¨ç½²æ•°æ®åº“æœåŠ¡

# 5. å¦‚æœæœåŠ¡å­˜åœ¨,æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
kubectl run test --image=mysql:8.0 -it --rm -- \
  mysql -h mysql.default.svc.cluster.local -u root -p

# 6. æ£€æŸ¥åº”ç”¨é…ç½®
kubectl get pod myapp-5d7f8c9b-xyz -o yaml | grep -A 10 env:
# æŸ¥çœ‹æ•°æ®åº“è¿æ¥é…ç½®æ˜¯å¦æ­£ç¡®
```

**3. å®¹å™¨äº¤äº’å‘½ä»¤**

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubectl exec - åœ¨å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# åœ¨Podä¸­æ‰§è¡Œå•ä¸ªå‘½ä»¤
kubectl exec <pod-name> -- ls -la /app

# åœ¨å¤šå®¹å™¨Podä¸­æŒ‡å®šå®¹å™¨
kubectl exec <pod-name> -c <container-name> -- ps aux

# è¿›å…¥å®¹å™¨äº¤äº’å¼shell
kubectl exec -it <pod-name> -- /bin/bash
kubectl exec -it <pod-name> -- /bin/sh  # å¦‚æœæ²¡æœ‰bash

# å¤šå®¹å™¨Podè¿›å…¥æŒ‡å®šå®¹å™¨
kubectl exec -it <pod-name> -c <container-name> -- /bin/bash

# åœ¨å®¹å™¨ä¸­æŸ¥çœ‹ç¯å¢ƒå˜é‡
kubectl exec <pod-name> -- env

# åœ¨å®¹å™¨ä¸­æµ‹è¯•ç½‘ç»œè¿é€šæ€§
kubectl exec <pod-name> -- ping 8.8.8.8
kubectl exec <pod-name> -- curl http://service-name:8080/health

# åœ¨å®¹å™¨ä¸­æ£€æŸ¥è¿›ç¨‹
kubectl exec <pod-name> -- ps aux
kubectl exec <pod-name> -- top -b -n 1

# åœ¨å®¹å™¨ä¸­æ£€æŸ¥æ–‡ä»¶
kubectl exec <pod-name> -- ls -la /var/log/
kubectl exec <pod-name> -- cat /etc/nginx/nginx.conf
```

### 11.1.3 å®¹å™¨è°ƒè¯•å®æˆ˜æŠ€å·§

#### 1. ä½¿ç”¨Ephemeralå®¹å™¨è°ƒè¯•

Kubernetes 1.23+ æ”¯æŒä¸´æ—¶è°ƒè¯•å®¹å™¨,è¿™æ˜¯è°ƒè¯•ç”Ÿäº§ç¯å¢ƒPodçš„æœ€ä½³å®è·µ:

```bash
# åœºæ™¯: ç”Ÿäº§Podä½¿ç”¨distrolessé•œåƒ,æ²¡æœ‰shellå’Œè°ƒè¯•å·¥å…·

# åœ¨è¿è¡Œçš„Podä¸­æ·»åŠ ä¸´æ—¶è°ƒè¯•å®¹å™¨
kubectl debug myapp-pod -it --image=busybox --target=myapp

# ä½¿ç”¨åŒ…å«æ›´å¤šå·¥å…·çš„é•œåƒ
kubectl debug myapp-pod -it --image=nicolaka/netshoot --target=myapp

# nicolaka/netshoot åŒ…å«çš„å·¥å…·:
# - tcpdump (ç½‘ç»œæŠ“åŒ…)
# - netstat/ss (è¿æ¥æŸ¥çœ‹)
# - curl/wget (HTTPæµ‹è¯•)
# - dig/nslookup (DNSæµ‹è¯•)
# - iperf (ç½‘ç»œæ€§èƒ½æµ‹è¯•)
# - strace (ç³»ç»Ÿè°ƒç”¨è·Ÿè¸ª)
# - htop (è¿›ç¨‹ç›‘æ§)
```

#### 2. å¤åˆ¶Podè¿›è¡Œè°ƒè¯•

å½“éœ€è¦ä¿®æ”¹Podé…ç½®è¿›è¡Œè°ƒè¯•æ—¶:

```bash
# å¤åˆ¶Podå¹¶ä¿®æ”¹å¯åŠ¨å‘½ä»¤
kubectl debug failing-pod -it --copy-to=debug-pod \
  --container=myapp -- /bin/sh

# åœ¨è°ƒè¯•Podä¸­æ‰‹åŠ¨è¿è¡Œåº”ç”¨
/app/start.sh

# è°ƒè¯•å®Œæˆååˆ é™¤
kubectl delete pod debug-pod
```

#### 3. èŠ‚ç‚¹çº§è°ƒè¯•

å½“éœ€è¦è®¿é—®èŠ‚ç‚¹æ–‡ä»¶ç³»ç»Ÿæ—¶:

```bash
# åœ¨èŠ‚ç‚¹ä¸Šåˆ›å»ºç‰¹æƒè°ƒè¯•Pod
kubectl debug node/node-1 -it --image=ubuntu

# èŠ‚ç‚¹çš„æ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åœ¨ /host
ls /host/var/log/
cat /host/etc/resolv.conf

# æ£€æŸ¥èŠ‚ç‚¹ä¸Šçš„å®¹å™¨
crictl ps
crictl logs <container-id>
```



### 11.1.4 ç½‘ç»œè°ƒè¯•å·¥å…·é“¾

Kubernetesç½‘ç»œé—®é¢˜æ˜¯æœ€å¸¸è§ä¹Ÿæœ€å¤æ‚çš„æ•…éšœç±»å‹ã€‚æŒæ¡ç½‘ç»œè°ƒè¯•å·¥å…·é“¾è‡³å…³é‡è¦ã€‚

#### ç½‘ç»œè°ƒè¯•å·¥å…·é•œåƒ

é¦–å…ˆå‡†å¤‡ä¸€ä¸ªåŒ…å«æ‰€æœ‰ç½‘ç»œå·¥å…·çš„è°ƒè¯•é•œåƒ:

```bash
# æ¨èä½¿ç”¨ nicolaka/netshoot é•œåƒ
# åŒ…å«: tcpdump, netstat, curl, dig, nslookup, iperf, nmapç­‰

# åˆ›å»ºç½‘ç»œè°ƒè¯•Pod
kubectl run netshoot --image=nicolaka/netshoot -it --rm -- bash

# æˆ–è€…ä½¿ç”¨busybox (æ›´è½»é‡)
kubectl run busybox --image=busybox:1.36 -it --rm -- sh
```

#### 1. DNSè°ƒè¯•

```bash
# åœ¨Podä¸­æµ‹è¯•DNSè§£æ
kubectl exec <pod-name> -- nslookup kubernetes.default
kubectl exec <pod-name> -- dig kubernetes.default.svc.cluster.local

# æ£€æŸ¥DNSé…ç½®
kubectl exec <pod-name> -- cat /etc/resolv.conf
# åº”è¯¥çœ‹åˆ°:
# nameserver 10.96.0.10  (CoreDNS Service IP)
# search default.svc.cluster.local svc.cluster.local cluster.local
# options ndots:5

# æµ‹è¯•DNSæœåŠ¡æ˜¯å¦æ­£å¸¸
kubectl run test-dns --image=busybox:1.36 -it --rm -- nslookup kubernetes.default

# æ£€æŸ¥CoreDNS PodçŠ¶æ€
kubectl get pods -n kube-system -l k8s-app=kube-dns

# æŸ¥çœ‹CoreDNSæ—¥å¿—
kubectl logs -n kube-system -l k8s-app=kube-dns --tail=100

# å¸¸è§DNSé—®é¢˜:
# 1. CoreDNS Podæœªè¿è¡Œ
# 2. CoreDNS Service ClusterIPé”™è¯¯
# 3. kubeletçš„--cluster-dnså‚æ•°é…ç½®é”™è¯¯
# 4. NetworkPolicyé˜»æ­¢DNSæµé‡
```

**DNSè°ƒè¯•å®æˆ˜æ¡ˆä¾‹**:

```yaml
# åœºæ™¯: Podæ— æ³•è§£æServiceåŸŸå

# 1. éªŒè¯DNSæœåŠ¡å­˜åœ¨
kubectl get svc -n kube-system kube-dns
# NAME       TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)         AGE
# kube-dns   ClusterIP   10.96.0.10   <none>        53/UDP,53/TCP   30d

# 2. æµ‹è¯•DNSè§£æ
kubectl run test --image=busybox:1.36 -it --rm -- nslookup my-service
# å¦‚æœè¿”å› "server can't find my-service: NXDOMAIN"
# è¯´æ˜DNSæœåŠ¡æ­£å¸¸,ä½†Serviceä¸å­˜åœ¨æˆ–åç§°é”™è¯¯

# 3. æ£€æŸ¥Serviceæ˜¯å¦å­˜åœ¨
kubectl get svc my-service
# å¦‚æœä¸å­˜åœ¨,éœ€è¦åˆ›å»ºService

# 4. æµ‹è¯•å®Œæ•´åŸŸå
kubectl run test --image=busybox:1.36 -it --rm -- \
  nslookup my-service.default.svc.cluster.local
# æˆåŠŸåˆ™è¯´æ˜éœ€è¦ä½¿ç”¨å®Œæ•´åŸŸåæˆ–é…ç½®searchåŸŸ

# 5. æ£€æŸ¥Podçš„resolv.conf
kubectl exec <pod-name> -- cat /etc/resolv.conf
```

#### 2. ç½‘ç»œè¿é€šæ€§æµ‹è¯•

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ping - ICMPæµ‹è¯•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æµ‹è¯•Pod IPè¿é€šæ€§
kubectl exec <source-pod> -- ping <target-pod-ip>

# æµ‹è¯•å¤–ç½‘è¿é€šæ€§
kubectl exec <pod-name> -- ping 8.8.8.8

# æ³¨æ„: æŸäº›ç½‘ç»œæ’ä»¶é»˜è®¤ç¦ç”¨ICMP,pingä¸é€šä¸ä»£è¡¨ç½‘ç»œä¸é€š

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# curl/wget - HTTPæµ‹è¯•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æµ‹è¯•Serviceè¿é€šæ€§ (HTTP)
kubectl exec <pod-name> -- curl -v http://my-service:8080

# æµ‹è¯•Pod IPç›´è¿
kubectl exec <pod-name> -- curl -v http://10.244.1.5:8080

# æµ‹è¯•å¤–éƒ¨URL
kubectl exec <pod-name> -- curl -v https://www.google.com

# æŸ¥çœ‹HTTPå“åº”å¤´
kubectl exec <pod-name> -- curl -I http://my-service:8080

# è®¾ç½®è¶…æ—¶æ—¶é—´
kubectl exec <pod-name> -- curl --max-time 5 http://my-service:8080

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# nc (netcat) - ç«¯å£æµ‹è¯•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æµ‹è¯•TCPç«¯å£è¿é€šæ€§
kubectl exec <pod-name> -- nc -zv my-service 8080
# è¾“å‡º: my-service (10.96.0.20:8080) open

# æµ‹è¯•UDPç«¯å£
kubectl exec <pod-name> -- nc -zuv my-service 53

# ç›‘å¬ç«¯å£ (æµ‹è¯•å…¥ç«™è¿æ¥)
kubectl exec <pod-name> -- nc -l -p 8080

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# telnet - ç«¯å£æµ‹è¯•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æµ‹è¯•TCPè¿æ¥
kubectl exec <pod-name> -- telnet my-service 8080
# æˆåŠŸ: Connected to my-service
# å¤±è´¥: Connection refused æˆ–è¶…æ—¶
```

#### 3. ç½‘ç»œæŠ“åŒ…åˆ†æ

ä½¿ç”¨tcpdumpæŠ“åŒ…æ˜¯è¯Šæ–­ç½‘ç»œé—®é¢˜çš„ç»ˆææ­¦å™¨:

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# tcpdumpåŸºç¡€ç”¨æ³•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# åœ¨Podä¸­æŠ“åŒ… (éœ€è¦NET_ADMIN capability)
kubectl exec <pod-name> -- tcpdump -i any -nn

# æŠ“å–ç‰¹å®šç«¯å£çš„åŒ…
kubectl exec <pod-name> -- tcpdump -i any -nn port 8080

# æŠ“å–ç‰¹å®šä¸»æœºçš„åŒ…
kubectl exec <pod-name> -- tcpdump -i any -nn host 10.244.1.5

# æŠ“å–HTTPæµé‡
kubectl exec <pod-name> -- tcpdump -i any -nn 'tcp port 80'

# ä¿å­˜æŠ“åŒ…åˆ°æ–‡ä»¶
kubectl exec <pod-name> -- tcpdump -i any -nn -w /tmp/capture.pcap
kubectl cp <pod-name>:/tmp/capture.pcap ./capture.pcap
# ä½¿ç”¨Wiresharkåˆ†æ

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# tcpdumpé«˜çº§è¿‡æ»¤
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŠ“å–SYNåŒ… (TCPæ¡æ‰‹)
kubectl exec <pod-name> -- tcpdump -i any 'tcp[tcpflags] & (tcp-syn) != 0'

# æŠ“å–HTTP POSTè¯·æ±‚
kubectl exec <pod-name> -- tcpdump -i any -s 0 -A 'tcp dst port 80 and (tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x504f5354)'

# æ’é™¤æŸäº›æµé‡
kubectl exec <pod-name> -- tcpdump -i any -nn not port 22

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# èŠ‚ç‚¹çº§æŠ“åŒ… (æ›´å…¨é¢)
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# SSHåˆ°èŠ‚ç‚¹
ssh node-1

# æŠ“å–æ‰€æœ‰æ¥å£çš„æµé‡
sudo tcpdump -i any -nn port 8080

# æŠ“å–ç‰¹å®šå®¹å™¨ç½‘ç»œå‘½åç©ºé—´çš„æµé‡
# 1. æ‰¾åˆ°å®¹å™¨ID
crictl ps | grep myapp

# 2. æ‰¾åˆ°å®¹å™¨çš„ç½‘ç»œå‘½åç©ºé—´
crictl inspect <container-id> | grep pid
# "pid": 12345

# 3. è¿›å…¥ç½‘ç»œå‘½åç©ºé—´æŠ“åŒ…
nsenter -t 12345 -n tcpdump -i eth0 -nn

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# å®æˆ˜æ¡ˆä¾‹ - æ’æŸ¥Serviceæ— æ³•è®¿é—®
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# åœºæ™¯: Pod A è®¿é—® Service B è¶…æ—¶

# 1. åœ¨Pod Aä¸­å‘èµ·è¯·æ±‚å¹¶æŠ“åŒ…
kubectl exec pod-a -- tcpdump -i any -nn port 8080 &
kubectl exec pod-a -- curl http://service-b:8080

# 2. åˆ†ææŠ“åŒ…ç»“æœ
# å¦‚æœçœ‹åˆ°: SYN -> SYN-ACK -> ACK (æ­£å¸¸ä¸‰æ¬¡æ¡æ‰‹)
# è¯´æ˜TCPè¿æ¥å»ºç«‹æˆåŠŸ,é—®é¢˜åœ¨åº”ç”¨å±‚

# å¦‚æœçœ‹åˆ°: SYN -> SYN -> SYN (é‡ä¼ )
# è¯´æ˜ç›®æ ‡ç«¯å£ä¸å¯è¾¾æˆ–è¢«é˜²ç«å¢™æ‹¦æˆª

# 3. åœ¨Pod Bä¸­æŠ“åŒ… (éªŒè¯æµé‡æ˜¯å¦åˆ°è¾¾)
kubectl exec pod-b -- tcpdump -i any -nn port 8080

# 4. å¦‚æœPod Bæ²¡æœ‰æ”¶åˆ°åŒ…,æ£€æŸ¥Serviceå’ŒEndpoints
kubectl get svc service-b
kubectl get endpoints service-b
```

#### 4. ç½‘ç»œè·¯å¾„è¿½è¸ª

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# traceroute - è·¯å¾„è¿½è¸ª
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# è¿½è¸ªåˆ°ç›®æ ‡çš„ç½‘ç»œè·¯å¾„
kubectl exec <pod-name> -- traceroute 8.8.8.8

# TCP traceroute (æ›´å¯é )
kubectl exec <pod-name> -- traceroute -T -p 80 www.google.com

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# mtr - æŒç»­è·¯å¾„è¿½è¸ª
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ç»“åˆpingå’Œtracerouteçš„åŠŸèƒ½
kubectl exec <pod-name> -- mtr 8.8.8.8

# ç”ŸæˆæŠ¥å‘Š
kubectl exec <pod-name> -- mtr --report 8.8.8.8
```

#### 5. ç«¯å£å’Œè¿æ¥æŸ¥çœ‹

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# netstat - ç½‘ç»œè¿æ¥æŸ¥çœ‹
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹æ‰€æœ‰TCPè¿æ¥
kubectl exec <pod-name> -- netstat -tan

# æŸ¥çœ‹ç›‘å¬ç«¯å£
kubectl exec <pod-name> -- netstat -tunlp

# æŸ¥çœ‹è¿æ¥ç»Ÿè®¡
kubectl exec <pod-name> -- netstat -s

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ss - socketç»Ÿè®¡ (æ›´ç°ä»£çš„å·¥å…·)
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹æ‰€æœ‰TCPè¿æ¥
kubectl exec <pod-name> -- ss -tan

# æŸ¥çœ‹ç›‘å¬ç«¯å£
kubectl exec <pod-name> -- ss -tunlp

# æŸ¥çœ‹ESTABLISHEDè¿æ¥
kubectl exec <pod-name> -- ss -tan state established

# ç»Ÿè®¡è¿æ¥æ•°
kubectl exec <pod-name> -- ss -s

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# lsof - æŸ¥çœ‹è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶å’Œç½‘ç»œè¿æ¥
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹è¿›ç¨‹ç›‘å¬çš„ç«¯å£
kubectl exec <pod-name> -- lsof -i -P -n

# æŸ¥çœ‹ç‰¹å®šç«¯å£è¢«å“ªä¸ªè¿›ç¨‹å ç”¨
kubectl exec <pod-name> -- lsof -i :8080
```

#### 6. ç½‘ç»œæ€§èƒ½æµ‹è¯•

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# iperf - ç½‘ç»œå¸¦å®½æµ‹è¯•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# åœ¨Pod Aä¸­å¯åŠ¨iperfæœåŠ¡å™¨
kubectl exec pod-a -- iperf -s

# åœ¨Pod Bä¸­è¿è¡Œiperfå®¢æˆ·ç«¯
kubectl exec pod-b -- iperf -c <pod-a-ip>

# è¾“å‡ºç¤ºä¾‹:
# ------------------------------------------------------------
# Client connecting to 10.244.1.5, TCP port 5001
# TCP window size: 85.0 KByte (default)
# ------------------------------------------------------------
# [  3] local 10.244.2.8 port 52434 connected with 10.244.1.5 port 5001
# [ ID] Interval       Transfer     Bandwidth
# [  3]  0.0-10.0 sec  1.10 GBytes   941 Mbits/sec

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# iperf3 - æ›´æ–°ç‰ˆæœ¬
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æœåŠ¡ç«¯
kubectl exec pod-a -- iperf3 -s

# å®¢æˆ·ç«¯ (TCPæµ‹è¯•)
kubectl exec pod-b -- iperf3 -c <pod-a-ip> -t 30

# å®¢æˆ·ç«¯ (UDPæµ‹è¯•)
kubectl exec pod-b -- iperf3 -c <pod-a-ip> -u -b 1G

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ping - å»¶è¿Ÿæµ‹è¯•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æµ‹è¯•å»¶è¿Ÿå’Œä¸¢åŒ…ç‡
kubectl exec <pod-name> -- ping -c 100 <target-ip>
# å…³æ³¨: min/avg/max/mdev å’Œ packet loss
```

#### 7. NetworkPolicyè°ƒè¯•

NetworkPolicyé—®é¢˜æ˜¯ç½‘ç»œæ•…éšœçš„å¸¸è§åŸå› :

```bash
# 1. æŸ¥çœ‹å½“å‰å‘½åç©ºé—´çš„NetworkPolicy
kubectl get networkpolicy

# 2. æŸ¥çœ‹NetworkPolicyè¯¦æƒ…
kubectl describe networkpolicy <policy-name>

# 3. æµ‹è¯•NetworkPolicyæ˜¯å¦ç”Ÿæ•ˆ
# åˆ›å»ºæµ‹è¯•Pod
kubectl run test-source --image=busybox -it --rm -- sh
# åœ¨å¦ä¸€ä¸ªç»ˆç«¯åˆ›å»ºç›®æ ‡Pod
kubectl run test-target --image=nginx --labels="app=test"

# åœ¨test-sourceä¸­æµ‹è¯•è¿æ¥
wget -O- http://test-target

# 4. å¦‚æœè¿æ¥è¢«é˜»æ­¢,æ£€æŸ¥NetworkPolicyè§„åˆ™
kubectl get networkpolicy -o yaml

# 5. ä¸´æ—¶ç¦ç”¨NetworkPolicy (è°ƒè¯•ç”¨)
kubectl delete networkpolicy <policy-name>
# é‡æ–°æµ‹è¯•è¿æ¥
```

**NetworkPolicyè°ƒè¯•æ¡ˆä¾‹**:

```yaml
# åœºæ™¯: Pod A æ— æ³•è®¿é—® Pod B

# 1. æ£€æŸ¥Pod Bçš„æ ‡ç­¾
kubectl get pod pod-b --show-labels
# Labels: app=backend,tier=database

# 2. æ£€æŸ¥æ˜¯å¦æœ‰NetworkPolicyåº”ç”¨åˆ°Pod B
kubectl get networkpolicy
kubectl describe networkpolicy backend-policy

# 3. ç¤ºä¾‹NetworkPolicy
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: backend-policy
spec:
  podSelector:
    matchLabels:
      app: backend
  policyTypes:
  - Ingress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          app: frontend  # åªå…è®¸frontend Podè®¿é—®
    ports:
    - protocol: TCP
      port: 3306

# 4. åˆ†æ: Pod A æ²¡æœ‰ app=frontend æ ‡ç­¾,æ‰€ä»¥è¢«æ‹’ç»

# 5. è§£å†³æ–¹æ¡ˆA: ç»™Pod Aæ·»åŠ æ ‡ç­¾
kubectl label pod pod-a app=frontend

# è§£å†³æ–¹æ¡ˆB: ä¿®æ”¹NetworkPolicy,å…è®¸Pod Aè®¿é—®
kubectl edit networkpolicy backend-policy
```

### 11.1.5 ç³»ç»Ÿçº§è°ƒè¯•å·¥å…·

å½“éœ€è¦æ·±å…¥åˆ°ç³»ç»Ÿå±‚é¢è°ƒè¯•æ—¶,éœ€è¦ä½¿ç”¨ä»¥ä¸‹å·¥å…·:

#### 1. strace - ç³»ç»Ÿè°ƒç”¨è·Ÿè¸ª

```bash
# è·Ÿè¸ªè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨
kubectl exec <pod-name> -- strace -p <pid>

# è·Ÿè¸ªæ–‡ä»¶æ“ä½œ
kubectl exec <pod-name> -- strace -e trace=open,read,write -p <pid>

# è·Ÿè¸ªç½‘ç»œæ“ä½œ
kubectl exec <pod-name> -- strace -e trace=network -p <pid>

# ç»Ÿè®¡ç³»ç»Ÿè°ƒç”¨
kubectl exec <pod-name> -- strace -c -p <pid>

# åœºæ™¯: åº”ç”¨æŒ‚èµ·ä¸å“åº”
# æŸ¥çœ‹åº”ç”¨æ­£åœ¨æ‰§è¡Œä»€ä¹ˆç³»ç»Ÿè°ƒç”¨
ps aux | grep myapp  # æ‰¾åˆ°PID
strace -p <pid>
# å¦‚æœçœ‹åˆ°å¤§é‡ futex(WAIT) è°ƒç”¨,å¯èƒ½æ˜¯æ­»é”
```

#### 2. lsof - æŸ¥çœ‹æ‰“å¼€çš„æ–‡ä»¶

```bash
# æŸ¥çœ‹è¿›ç¨‹æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶
kubectl exec <pod-name> -- lsof -p <pid>

# æŸ¥çœ‹è¿›ç¨‹æ‰“å¼€çš„ç½‘ç»œè¿æ¥
kubectl exec <pod-name> -- lsof -i -p <pid>

# æŸ¥çœ‹å“ªä¸ªè¿›ç¨‹åœ¨ä½¿ç”¨æŸä¸ªæ–‡ä»¶
kubectl exec <pod-name> -- lsof /var/log/app.log

# åœºæ™¯: ç£ç›˜ç©ºé—´æ»¡,ä½†åˆ é™¤æ–‡ä»¶åç©ºé—´æœªé‡Šæ”¾
# åŸå› : è¿›ç¨‹ä»ç„¶æŒæœ‰å·²åˆ é™¤æ–‡ä»¶çš„å¥æŸ„
lsof | grep deleted
# éœ€è¦é‡å¯æŒæœ‰å¥æŸ„çš„è¿›ç¨‹
```

#### 3. top/htop - è¿›ç¨‹ç›‘æ§

```bash
# æŸ¥çœ‹è¿›ç¨‹èµ„æºä½¿ç”¨
kubectl exec <pod-name> -- top -b -n 1

# æ›´å‹å¥½çš„ç•Œé¢ (å¦‚æœå®¹å™¨ä¸­æœ‰htop)
kubectl exec <pod-name> -it -- htop

# æŒ‰å†…å­˜æ’åº
kubectl exec <pod-name> -- top -o %MEM

# æŸ¥çœ‹ç‰¹å®šè¿›ç¨‹çš„çº¿ç¨‹
kubectl exec <pod-name> -- top -H -p <pid>
```

#### 4. èŠ‚ç‚¹çº§è°ƒè¯•

```bash
# SSHåˆ°èŠ‚ç‚¹
ssh node-1

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ç³»ç»Ÿèµ„æºæŸ¥çœ‹
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# CPUä½¿ç”¨æƒ…å†µ
mpstat 1 5

# å†…å­˜ä½¿ç”¨æƒ…å†µ
free -h
vmstat 1 5

# ç£ç›˜IO
iostat -x 1 5

# ç£ç›˜ç©ºé—´
df -h

# inodeä½¿ç”¨æƒ…å†µ
df -i

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# å®¹å™¨è¿è¡Œæ—¶è°ƒè¯•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨
crictl ps

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
crictl logs <container-id>

# æŸ¥çœ‹å®¹å™¨è¯¦æƒ…
crictl inspect <container-id>

# è¿›å…¥å®¹å™¨
crictl exec -it <container-id> /bin/sh

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# kubeletæ—¥å¿—
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æŸ¥çœ‹kubeletæ—¥å¿—
journalctl -u kubelet -f

# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯
journalctl -u kubelet -p err -n 50

# æŒ‰æ—¶é—´è¿‡æ»¤
journalctl -u kubelet --since "2024-02-08 10:00:00"
```

### 11.1.6 è°ƒè¯•å‘½ä»¤é€ŸæŸ¥è¡¨

ä»¥ä¸‹æ˜¯å¸¸ç”¨è°ƒè¯•å‘½ä»¤çš„å¿«é€Ÿå‚è€ƒ:

```bash
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PodçŠ¶æ€è¯Šæ–­
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
kubectl get pods                          # æŸ¥çœ‹PodçŠ¶æ€
kubectl describe pod <pod-name>           # æŸ¥çœ‹Podè¯¦æƒ…å’Œäº‹ä»¶
kubectl logs <pod-name> --previous        # æŸ¥çœ‹å´©æºƒå‰æ—¥å¿—
kubectl get events --sort-by='.lastTimestamp' | head -20  # æœ€è¿‘äº‹ä»¶

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ç½‘ç»œè¯Šæ–­
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
kubectl exec <pod> -- nslookup <service>  # DNSè§£ææµ‹è¯•
kubectl exec <pod> -- curl http://<svc>   # HTTPè¿é€šæ€§æµ‹è¯•
kubectl exec <pod> -- nc -zv <host> <port>  # ç«¯å£è¿é€šæ€§æµ‹è¯•
kubectl exec <pod> -- tcpdump -i any -nn  # ç½‘ç»œæŠ“åŒ…

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# èµ„æºè¯Šæ–­
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
kubectl top node                          # èŠ‚ç‚¹èµ„æºä½¿ç”¨
kubectl top pod                           # Podèµ„æºä½¿ç”¨
kubectl describe node <node>              # èŠ‚ç‚¹è¯¦æƒ…

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# åº”ç”¨è°ƒè¯•
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
kubectl exec -it <pod> -- /bin/bash       # è¿›å…¥å®¹å™¨
kubectl cp <pod>:/path/to/file ./file     # å¤åˆ¶æ–‡ä»¶
kubectl port-forward <pod> 8080:80        # ç«¯å£è½¬å‘
kubectl debug <pod> -it --image=busybox   # ä¸´æ—¶è°ƒè¯•å®¹å™¨

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# å¿«é€Ÿä¿®å¤
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
kubectl delete pod <pod>                  # é‡å¯Pod
kubectl rollout restart deployment <name> # é‡å¯Deployment
kubectl rollout undo deployment <name>    # å›æ»šç‰ˆæœ¬
kubectl scale deployment <name> --replicas=3  # æ‰©ç¼©å®¹
```

---

**æœ¬èŠ‚å°ç»“**

åœ¨11.1èŠ‚ä¸­,æˆ‘ä»¬ç³»ç»Ÿå­¦ä¹ äº†Kubernetesè°ƒè¯•çš„æ–¹æ³•è®ºå’Œå·¥å…·:

1. **æ•…éšœæ’æŸ¥æ–¹æ³•è®º**:
   - USEæ–¹æ³• (Utilization, Saturation, Errors)
   - REDæ–¹æ³• (Rate, Errors, Duration)
   - Google SREå››å¤§é»„é‡‘æŒ‡æ ‡
   - 5W1Hæ•…éšœåˆ†ææ³•
   - æ•…éšœæ’æŸ¥å…­æ­¥æ³•

2. **kubectlæ ¸å¿ƒå‘½ä»¤**:
   - èµ„æºæŸ¥çœ‹: get, describe, top, events
   - æ—¥å¿—æŸ¥çœ‹: logs (--previous, --tail, -f)
   - å®¹å™¨äº¤äº’: exec, cp
   - èµ„æºç¼–è¾‘: edit, patch, scale, set
   - å‘å¸ƒç®¡ç†: rollout
   - ä¸´æ—¶è°ƒè¯•: debug, run, port-forward

3. **å®¹å™¨è°ƒè¯•æŠ€å·§**:
   - é•œåƒæ‹‰å–å¤±è´¥å¤„ç†
   - CrashLoopBackOffæ’æŸ¥
   - OOMKilledé—®é¢˜è§£å†³
   - Ephemeralå®¹å™¨ä½¿ç”¨
   - èŠ‚ç‚¹çº§è°ƒè¯•

4. **ç½‘ç»œè°ƒè¯•å·¥å…·é“¾**:
   - DNSè°ƒè¯• (nslookup, dig)
   - è¿é€šæ€§æµ‹è¯• (ping, curl, nc, telnet)
   - ç½‘ç»œæŠ“åŒ… (tcpdump)
   - è·¯å¾„è¿½è¸ª (traceroute, mtr)
   - è¿æ¥æŸ¥çœ‹ (netstat, ss, lsof)
   - æ€§èƒ½æµ‹è¯• (iperf)
   - NetworkPolicyè°ƒè¯•

5. **ç³»ç»Ÿçº§å·¥å…·**:
   - strace (ç³»ç»Ÿè°ƒç”¨è·Ÿè¸ª)
   - lsof (æ–‡ä»¶å¥æŸ„)
   - top/htop (è¿›ç¨‹ç›‘æ§)
   - èŠ‚ç‚¹çº§è¯Šæ–­

æŒæ¡è¿™äº›å·¥å…·å’Œæ–¹æ³•å,ä½ å°†èƒ½å¤Ÿå¿«é€Ÿå®šä½å’Œè§£å†³90%ä»¥ä¸Šçš„Kubernetesé—®é¢˜ã€‚åœ¨åç»­ç« èŠ‚ä¸­,æˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ å…·ä½“çš„æ•…éšœåœºæ™¯å’Œè§£å†³æ–¹æ¡ˆã€‚

---

